(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function a(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(o){if(o.ep)return;o.ep=!0;const c=a(o);fetch(o.href,c)}})();const ae="todo-monster-data";function O(){return{todos:[],character:{name:"ãƒŠã‚¾ã‚¿ãƒ",level:1,exp:0,branch:null},personality:{creative:0,physical:0,social:0,intellectual:0,chaotic:0},chatLog:[],apiKey:"",friends:[],lastAccessDate:""}}function oe(){try{const e=localStorage.getItem(ae);if(!e)return O();const t=JSON.parse(e),a=O(),n={...a,...t,character:{...a.character,...t.character},personality:{...a.personality,...t.personality}};t.friend&&!t.friends&&(n.friends=[t.friend],delete n.friend),Array.isArray(n.friends)||(n.friends=[]),n.lastAccessDate||(n.lastAccessDate="");for(const o of n.todos){if(!o.scheduledDate)if(o.completedAt){const c=new Date(o.completedAt);o.scheduledDate=`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`}else{const c=new Date;o.scheduledDate=`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`}o.isRecurring===void 0&&(o.isRecurring=!1)}return n}catch{return O()}}function b(e){localStorage.setItem(ae,JSON.stringify(e))}function S(){const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function q(){const e=new Date;return e.setDate(e.getDate()-1),`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function Y(){const e=new Date;return e.setDate(e.getDate()+1),`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function ue(e){const t=S(),a=q(),n=Y();if(e===t)return"ãã‚‡ã†";if(e===a)return"ãã®ã†";if(e===n)return"ã‚ã—ãŸ";const o=e.split("-");return`${parseInt(o[1])}/${parseInt(o[2])}`}function me(e){const t=S();if(e.lastAccessDate===t)return e;const a={...e,lastAccessDate:t},n=e.todos.filter(o=>o.isRecurring&&o.scheduledDate!==t);for(const o of n)e.todos.some(s=>s.text===o.text&&s.scheduledDate===t&&!s.completed)||a.todos.unshift({id:Date.now().toString(36)+Math.random().toString(36).slice(2,6),text:o.text,category:o.category,completed:!1,completedAt:null,scheduledDate:t,isRecurring:!0});return a}const fe={creative:["æ","çµµ","ã‚¤ãƒ©ã‚¹ãƒˆ","æ›²","éŸ³æ¥½","ä½œæ›²","æ­Œ","å†™çœŸ","å‹•ç”»","ãƒ‡ã‚¶ã‚¤ãƒ³","æ’®å½±","ãƒ”ã‚¢ãƒ","ã‚®ã‚¿ãƒ¼","å°èª¬","è©©","å‰µä½œ","ã‚¢ãƒ¼ãƒˆ","ç·¨é›†","DIY","æ‰‹èŠ¸","æ–™ç†","ãƒ¬ã‚·ãƒ”","ã‚«ãƒ¡ãƒ©","æ˜ ç”»"],physical:["èµ°","ç­‹ãƒˆãƒ¬","ã‚¸ãƒ ","æ³³","ç™»å±±","ãƒ¨ã‚¬","ã‚¹ãƒˆãƒ¬ãƒƒãƒ","æ•£æ­©","ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°","ã‚¸ãƒ§ã‚®ãƒ³ã‚°","ã‚µãƒƒã‚«ãƒ¼","é‡çƒ","ãƒ†ãƒ‹ã‚¹","ãƒã‚¹ã‚±","è…•ç«‹ã¦","è…¹ç­‹","ãƒ€ãƒ³ã‚¹","è‡ªè»¢è»Š","ãƒã‚¤ã‚­ãƒ³ã‚°","ãƒãƒ©ã‚½ãƒ³","ã‚­ãƒ£ãƒ³ãƒ—","æƒé™¤","ç‰‡ä»˜ã‘"],social:["å‹é”","éŠã¶","ãƒ‘ãƒ¼ãƒ†ã‚£","é£²ã¿","ã”é£¯","ä¼šã†","é›»è©±","æ‰‹ç´™","ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ","ãƒ‡ãƒ¼ãƒˆ","èª•ç”Ÿæ—¥","ã‚¤ãƒ™ãƒ³ãƒˆ","æ—…è¡Œ","å®¶æ—","é€£çµ¡","ç›¸è«‡","ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢","ãŠç¥ã„","LINE","SNS"],intellectual:["èª­","å‹‰å¼·","æœ¬","è³‡æ ¼","è©¦é¨“","è‹±èª","æ•°å­¦","ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°","è«–æ–‡","ç ”ç©¶","å­¦ç¿’","è¬›åº§","ã‚»ãƒŸãƒŠãƒ¼","ãƒ‹ãƒ¥ãƒ¼ã‚¹","æ­´å²","ç§‘å­¦","å“²å­¦","ãƒ¬ãƒãƒ¼ãƒˆ","ãƒ‘ã‚ºãƒ«","å°†æ£‹","ãƒã‚§ã‚¹"],chaotic:["å¤‰ãª","ãŠã‹ã—ã„","ã‚„ã°ã„","å«","å…¨åŠ›","ç„¡èŒ¶","ãƒãƒ£ãƒ¬ãƒ³ã‚¸","ãƒã‚¿","çˆ†ç¬‘","é©å½“","ãªã‚“ã§ã‚‚ã„ã„","ãƒ©ãƒ³ãƒ€ãƒ ","å†’é™º","è¸Šã‚Šç‹‚","ã‚³ã‚¹ãƒ—ãƒ¬","ã©ã£ãã‚Š","ãŠãµã–ã‘","é™ç•Œ","ã¶ã£é£›"]};function he(e){const t={creative:0,physical:0,social:0,intellectual:0,chaotic:0};for(const[o,c]of Object.entries(fe))for(const s of c)e.includes(s)&&t[o]++;const a=Math.max(...Object.values(t));if(a===0){const o=Object.keys(t);return o[Math.floor(Math.random()*o.length)]}const n=Object.entries(t).filter(([,o])=>o===a).map(([o])=>o);return n[Math.floor(Math.random()*n.length)]}function ye(e,t=null,a=!1){return{id:Date.now().toString(36)+Math.random().toString(36).slice(2,6),text:e,category:he(e),completed:!1,completedAt:null,scheduledDate:t||S(),isRecurring:a}}function P(e){return{creative:"ğŸ¨",physical:"ğŸ’ª",social:"ğŸ—£ï¸",intellectual:"ğŸ“š",chaotic:"ğŸ‰"}[e]||"â“"}function ge(e){return{creative:"ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–",physical:"ãƒ•ã‚£ã‚¸ã‚«ãƒ«",social:"ã‚½ãƒ¼ã‚·ãƒ£ãƒ«",intellectual:"ã‚¤ãƒ³ãƒ†ãƒ¬ã‚¯ãƒãƒ¥ã‚¢ãƒ«",chaotic:"ã‚«ã‚ªã‚¹"}[e]||"ä¸æ˜"}function ve(e,t){const a={...e};a[t]=(a[t]||0)+3;const o=Object.keys(a).filter(s=>s!==t),c=o[Math.floor(Math.random()*o.length)];return a[c]=(a[c]||0)+1,a}function Ee(e){let t=-1,a="creative";for(const[n,o]of Object.entries(e))o>t&&(t=o,a=n);return a}function be(e){return Object.values(e).reduce((t,a)=>t+a,0)}function ce(e){if(be(e)===0)return"ã¾ã ä½•ã‚‚ã—ã¦ãªã„ã‹ã‚‰ã€ã‚ˆãã‚ã‹ã‚“ãªã„â€¦";const a=Object.entries(e).sort(([,i],[,u])=>u-i).filter(([,i])=>i>0),n={creative:"ã‚‚ã®ã¥ãã‚ŠãŒå¥½ã",physical:"ä½“ã‚’å‹•ã‹ã™ã®ãŒå¥½ã",social:"ã¿ã‚“ãªã¨ä¸€ç·’ãŒã†ã‚Œã—ã„",intellectual:"è€ƒãˆã”ã¨ãŒæ¥½ã—ã„",chaotic:"ä½•ã§ã‚‚ã‚¢ãƒª"};if(a.length===1)return n[a[0][0]];const[o,c]=a,s=n[o[0]],l=n[c[0]];return o[1]-c[1]<=2?`${s}ã§ã€${l}ã‚¿ã‚¤ãƒ—`:`${s}ã€‚ã¡ã‚‡ã£ã¨ã ã‘${l}`}const T=[0,0,3,8,15,25],se=1,U={1:"ã‚¿ãƒã‚´",2:"ã‚‚ã¡ã¾ã‚‹"},Ce={creative:[{3:"ãƒ‘ãƒ¬ãƒƒãƒˆãƒ³",4:"ã‚¢ãƒ¼ãƒˆãƒ©ã‚´ãƒ³",5:"è™¹ç­†ãƒã‚¹ã‚¿ãƒ¼"},{3:"ã‚¯ãƒ¬ãƒ¨ãƒ³ã‚³",4:"ã‚¹ã‚±ãƒƒãƒãƒ¢ãƒ³",5:"è‰²å½©ã®å¤§é­”å°å¸«"},{3:"ã„ã‚ã©ã‚Šã‚“",4:"ã‚«ãƒ©ãƒ•ãƒ«ãƒ¼ãƒ³",5:"å¹»æƒ³ç”»ä¼¯"},{3:"ãˆã®ãã¡ã‚ƒã‚“",4:"ã‚­ãƒ£ãƒ³ãƒã‚¹ãƒ³",5:"ã‚¢ãƒ¼ãƒˆã®ç¥"},{3:"ã¬ã‚Šã¬ã‚Šã‚“",4:"ãƒ‡ã‚¶ã‚¤ãƒ¢ãƒ³",5:"å‰µé€ ã®ç‹"},{3:"ãŠãˆã‹ãã‚“",4:"ãƒŸãƒ¥ãƒ¼ã‚ºãƒ¢ãƒ³",5:"å¤¢è¦‹ã®èŠ¸è¡“å®¶"}],physical:[{3:"ãƒãƒƒã‚¹ãƒ³",4:"ã‚´ãƒªãƒ‰ãƒ³",5:"é‹¼é‰„ãƒãƒ£ãƒ³ãƒ—"},{3:"ãƒ€ãƒƒã‚·ãƒ¥ãƒ³",4:"ãƒ‘ãƒ¯ãƒ‰ãƒ©ã‚´",5:"ç­‹è‚‰ã®è¦‡è€…"},{3:"ãã‚“ã«ãã‚“",4:"ã‚¹ãƒˆãƒ­ãƒ³ã‚°ãƒ¢ãƒ³",5:"é‰„å£ã®å·¨äºº"},{3:"ã¯ã—ã‚‹ã‚“",4:"ã‚¢ã‚¹ãƒªãƒ¼ãƒˆãƒ³",5:"ç–¾é¢¨ã®æ‹³ç‹"},{3:"ãŸã„ã‚Šã‚‡ãã‚“",4:"ãƒ•ã‚¡ã‚¤ãƒˆãƒ©",5:"ä¸å±ˆã®å‹‡è€…"},{3:"ã‚¸ãƒ£ãƒ³ãƒ—ãƒ³",4:"ãƒ“ãƒ«ãƒ‰ãƒ¢ãƒ³",5:"ä¼èª¬ã®é‰„äºº"}],social:[{3:"ãŠã—ã‚ƒã¹ã‚Šã‚“",4:"ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ©",5:"ç¥­ã‚Šã®ç‹"},{3:"ãªã‹ã‚ˆã—ã‚“",4:"ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒ©",5:"çµ†ã®å¤§è³¢è€…"},{3:"ã‚ã„ã‚ã„ã‚“",4:"ã‚½ãƒ¼ã‚·ãƒ£ãƒ­ãƒ³",5:"å‹æƒ…ã®ç¥"},{3:"ã«ã“ã«ã“ã‚“",4:"ãƒã‚¢ãƒ•ãƒ«ãƒ¢ãƒ³",5:"ç¬‘é¡”ã®å¤§é­”ç‹"},{3:"ã¯ãªã—ã£ã“",4:"ã‚³ãƒŸãƒ¥ãƒ‹ã‚ªãƒ³",5:"ãŠã‚‚ã¦ãªã—ã®ç‹"},{3:"ããšãªã¡ã‚ƒã‚“",4:"ãƒãƒ¼ãƒˆãƒ•ãƒ«ãƒ³",5:"ä¸‡äººã®å‘³æ–¹"}],intellectual:[{3:"ãƒ¡ã‚¬ãƒãƒ¢ãƒ³",4:"ãƒ–ãƒƒã‚¯ãƒ‰ãƒ©ã‚´",5:"å…¨çŸ¥ã®è³¢è€…"},{3:"ã‚ˆã¿ã‚ˆã¿ã‚“",4:"ã‚·ãƒ³ã‚«ãƒ¼ãƒ¢ãƒ³",5:"çŸ¥æµã®å¤§é•·è€"},{3:"ã¹ã‚“ãã‚‡ã†ã‚“",4:"ãƒ­ã‚¸ã‚«ãƒ­ãƒ³",5:"çœŸç†ã®æ¢ç©¶è€…"},{3:"ãšã®ã†ã¡ã‚ƒã‚“",4:"ãƒŠãƒ¬ãƒƒã‚¸ãƒ¢ãƒ³",5:"å¡æ™ºã®çµæ™¶"},{3:"ã²ã‚‰ã‚ãã‚“",4:"ã‚¢ã‚¤ãƒ‡ã‚£ã‚¢ãƒ©",5:"çŸ¥ã®ç¥æ®¿"},{3:"ã‚‚ã®çŸ¥ã‚Šã‚“",4:"ã‚¦ã‚£ã‚ºãƒ€ãƒ¢ãƒ³",5:"åšè­˜ã®å®ˆè­·è€…"}],chaotic:[{3:"ãã‚‹ãã‚‹ã‚“",4:"ã‚«ã‚ªã‚¹ã‚‚ã‚“",5:"æ··æ²Œã®åŒ–èº«"},{3:"ã§ãŸã‚‰ã‚ã‚“",4:"ãƒ©ãƒ³ãƒ€ãƒ¢ãƒ³",5:"äºˆæ¸¬ä¸èƒ½ã®åµ"},{3:"ã¯ã¡ã‚ƒã‚ã¡ã‚ƒã‚“",4:"ãƒˆãƒªãƒƒã‚¯ã‚¹ã‚¿",5:"ç¬‘ã„ã®æ”¯é…è€…"},{3:"ãµã—ãã¡ã‚ƒã‚“",4:"ãƒŸã‚¹ãƒ†ãƒªã‚ªãƒ³",5:"å¥‡è·¡ã®ä½“ç¾è€…"},{3:"ã„ãŸãšã‚‰ã‚“",4:"ã‚¸ãƒ§ãƒ¼ã‚«ãƒ¢ãƒ³",5:"è‡ªç”±ã®åŒ–èº«"},{3:"ãã¾ãã‚Œã‚“",4:"ãƒ¯ã‚¤ãƒ«ãƒ‰ãƒ©",5:"ç„¡ç§©åºã®ç‹"}]},Ae={creative:"è‰²ã¨å½¢ã‚’æ“ã‚‹èŠ¸è¡“æ´¾",physical:"ç­‹è‚‰ã§å…¨ã¦ã‚’è§£æ±ºã™ã‚‹è„³ç­‹æ´¾",social:"è©±ã—ä¸Šæ‰‹ã®äººæ°—è€…",intellectual:"çŸ¥è­˜ã‚’è²ªã‚‹è³¢è€…ã‚¿ã‚¤ãƒ—",chaotic:"äºˆæ¸¬ä¸èƒ½ã®ãƒˆãƒªãƒƒã‚¯ã‚¹ã‚¿ãƒ¼"};function Se(e){let t=5381;for(let a=0;a<e.length;a++)t=(t<<5)+t+e.charCodeAt(a)|0;return Math.abs(t)}function ke(e){return Se(e)%6}function re(e){const{level:t,branch:a,name:n}=e;if(t<=2)return U[t];if(!a)return U[2];const o=ke(n||"ãƒŠã‚¾ã‚¿ãƒ"),c=Ce[a];return c&&c[o%c.length][t]||"???"}function xe(e){return Ae[e]||""}function Be(e){return e.level>=5?0:T[e.level+1]-e.exp}function De(e){if(e.level>=5)return 1;const t=T[e.level],n=T[e.level+1]-t;return n<=0?1:Math.min(1,(e.exp-t)/n)}function Me(e,t,a=se){const n={...e};n.exp+=a;let o=!1,c=null;for(;n.level<5&&n.exp>=T[n.level+1];)n.level++,o=!0,n.level===3&&!n.branch&&(n.branch=Ee(t)),n.name=re(n),c=n.name;return{character:n,evolved:o,newStageName:c}}const $=[{name:"ã‚¹ãƒ©ã‚¤ãƒ ",data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,7,7,7,7,0,0,0,0,0,0],[0,0,0,0,0,7,1,1,1,1,7,0,0,0,0,0],[0,0,0,0,7,1,4,4,1,1,1,7,0,0,0,0],[0,0,0,7,1,4,1,1,1,1,1,1,7,0,0,0],[0,0,0,7,1,1,1,1,1,1,1,1,7,0,0,0],[0,0,7,1,1,1,3,1,1,3,1,1,1,7,0,0],[0,0,7,1,1,1,3,1,1,3,1,1,1,7,0,0],[0,0,7,1,1,1,1,1,1,1,1,1,1,7,0,0],[0,0,7,1,1,1,1,5,5,1,1,1,1,7,0,0],[0,0,7,1,1,1,1,1,1,1,1,1,1,7,0,0],[0,0,7,2,1,1,1,1,1,1,1,1,2,7,0,0],[0,0,0,7,2,1,1,1,1,1,1,2,7,0,0,0],[0,0,0,7,2,2,1,1,1,1,2,2,7,0,0,0],[0,0,0,0,7,7,2,1,1,2,7,7,0,0,0,0],[0,0,0,0,0,0,7,7,7,7,0,0,0,0,0,0]]},{name:"ã‚¿ãƒã‚´",data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,7,7,7,7,0,0,0,0,0,0],[0,0,0,0,0,7,1,4,4,1,7,0,0,0,0,0],[0,0,0,0,7,1,4,1,1,1,1,7,0,0,0,0],[0,0,0,0,7,1,1,1,1,1,1,7,0,0,0,0],[0,0,0,7,1,1,1,1,1,1,1,1,7,0,0,0],[0,0,0,7,1,1,1,1,1,1,1,1,7,0,0,0],[0,0,0,7,1,1,1,1,1,1,1,1,7,0,0,0],[0,0,7,1,1,1,1,1,1,1,1,1,1,7,0,0],[0,0,7,1,1,1,1,1,1,1,1,1,1,7,0,0],[0,0,7,1,1,1,1,1,1,1,1,1,1,7,0,0],[0,0,7,2,1,1,1,1,1,1,1,1,2,7,0,0],[0,0,0,7,2,2,1,1,1,1,2,2,7,0,0,0],[0,0,0,0,7,7,2,2,2,2,7,7,0,0,0,0],[0,0,0,0,0,0,7,7,7,7,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{name:"ã²ã‚ˆã“",data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,6,6,0,0,0,0,0,0,0],[0,0,0,0,0,0,6,6,6,6,0,0,0,0,0,0],[0,0,0,0,0,7,7,7,7,7,7,0,0,0,0,0],[0,0,0,0,7,1,4,4,1,1,1,7,0,0,0,0],[0,0,0,7,1,4,1,1,1,1,1,1,7,0,0,0],[0,0,0,7,1,1,3,1,1,3,1,1,7,0,0,0],[0,0,0,7,1,1,3,1,1,3,1,1,7,0,0,0],[0,0,0,7,1,1,1,1,1,1,1,1,7,0,0,0],[0,0,7,1,1,1,1,5,5,1,1,1,1,7,0,0],[0,6,7,1,1,1,1,1,1,1,1,1,1,7,6,0],[0,0,7,2,1,1,1,1,1,1,1,1,2,7,0,0],[0,0,0,7,2,2,1,1,1,1,2,2,7,0,0,0],[0,0,0,0,7,7,7,7,7,7,7,7,0,0,0,0],[0,0,0,0,0,6,6,0,0,6,6,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{name:"ãŠã°ã‘",data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,7,7,7,7,7,7,0,0,0,0,0],[0,0,0,0,7,1,4,4,1,1,1,7,0,0,0,0],[0,0,0,7,1,4,1,1,1,1,1,1,7,0,0,0],[0,0,0,7,1,1,1,1,1,1,1,1,7,0,0,0],[0,0,7,1,1,1,1,1,1,1,1,1,1,7,0,0],[0,0,7,1,1,3,3,1,1,3,3,1,1,7,0,0],[0,0,7,1,1,3,3,1,1,3,3,1,1,7,0,0],[0,0,7,1,1,1,1,1,1,1,1,1,1,7,0,0],[0,0,7,1,1,1,1,5,5,1,1,1,1,7,0,0],[0,0,7,1,1,1,1,1,1,1,1,1,1,7,0,0],[0,0,7,2,1,1,1,1,1,1,1,1,2,7,0,0],[0,0,7,2,2,1,1,2,2,1,1,2,2,7,0,0],[0,0,7,2,0,7,2,0,0,2,7,0,2,7,0,0],[0,0,0,0,0,0,7,0,0,7,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{name:"ãƒ‰ãƒ©ã‚´ãƒ³",data:[[0,0,0,6,0,0,0,0,0,0,0,0,6,0,0,0],[0,0,0,0,6,0,0,0,0,0,0,6,0,0,0,0],[0,0,0,0,0,7,7,7,7,7,7,0,0,0,0,0],[0,0,0,0,7,1,4,4,1,1,1,7,0,0,0,0],[0,0,0,7,1,4,1,1,1,1,1,1,7,0,0,0],[0,0,0,7,1,1,3,1,1,3,1,1,7,0,0,0],[0,0,0,7,1,1,3,1,1,3,1,1,7,0,0,0],[0,0,7,1,1,1,1,1,1,1,1,1,1,7,0,0],[0,0,7,1,1,1,1,5,5,1,1,1,1,7,0,0],[0,6,7,1,1,1,1,1,1,1,1,1,1,7,6,0],[6,6,7,2,1,1,1,1,1,1,1,1,2,7,6,6],[0,6,0,7,2,1,1,1,1,1,1,2,7,0,6,0],[0,0,0,0,7,2,1,1,1,1,2,7,0,0,0,0],[0,0,0,0,0,7,7,7,7,7,7,0,0,0,0,0],[0,0,0,0,0,6,0,0,0,0,6,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{name:"ãƒã‚³",data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,7,7,0,0,0,0,0,0,7,7,0,0,0],[0,0,0,7,1,7,0,0,0,0,7,1,7,0,0,0],[0,0,0,0,7,1,7,7,7,7,1,7,0,0,0,0],[0,0,0,0,7,1,4,4,1,1,1,7,0,0,0,0],[0,0,0,7,1,1,1,1,1,1,1,1,7,0,0,0],[0,0,0,7,1,1,3,1,1,3,1,1,7,0,0,0],[0,0,0,7,1,1,1,1,1,1,1,1,7,0,0,0],[0,0,0,7,1,5,1,1,1,1,5,1,7,0,0,0],[0,0,0,7,1,1,1,5,5,1,1,1,7,0,0,0],[0,0,0,7,2,1,1,1,1,1,1,2,7,0,0,0],[0,0,0,0,7,2,1,1,1,1,2,7,0,0,0,0],[0,0,0,0,0,7,7,7,7,7,7,0,0,0,0,0],[0,0,0,0,0,6,0,0,0,0,6,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{name:"ã‚´ãƒ¼ãƒ¬ãƒ ",data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,7,7,7,7,7,7,7,7,7,7,0,0,0],[0,0,7,1,1,4,4,1,1,1,1,1,1,7,0,0],[0,0,7,1,4,1,1,1,1,1,1,1,1,7,0,0],[0,0,7,1,1,1,1,1,1,1,1,1,1,7,0,0],[0,0,7,1,1,3,3,1,1,3,3,1,1,7,0,0],[0,0,7,1,1,3,3,1,1,3,3,1,1,7,0,0],[0,7,1,1,1,1,1,1,1,1,1,1,1,1,7,0],[0,7,1,1,1,1,1,5,5,1,1,1,1,1,7,0],[0,7,1,1,1,1,1,1,1,1,1,1,1,1,7,0],[0,7,2,1,1,1,1,1,1,1,1,1,1,2,7,0],[0,0,7,2,1,1,1,1,1,1,1,1,2,7,0,0],[0,0,0,7,7,2,1,1,1,1,2,7,7,0,0,0],[0,0,0,0,7,7,7,7,7,7,7,7,0,0,0,0],[0,0,0,0,6,6,0,0,0,0,6,6,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{name:"ã‚³ã‚¦ãƒ¢ãƒª",data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,7,7,0,0,7,7,0,0,0,0,0],[0,0,0,0,0,0,7,7,7,7,0,0,0,0,0,0],[0,0,0,0,0,7,1,4,4,1,7,0,0,0,0,0],[0,0,0,0,7,1,1,1,1,1,1,7,0,0,0,0],[0,0,0,0,7,1,3,1,1,3,1,7,0,0,0,0],[0,0,0,0,7,1,1,1,1,1,1,7,0,0,0,0],[0,6,6,7,1,1,1,5,5,1,1,1,7,6,6,0],[6,1,6,7,1,1,1,1,1,1,1,1,7,6,1,6],[0,6,0,7,2,1,1,1,1,1,1,2,7,0,6,0],[0,0,6,0,7,2,1,1,1,1,2,7,0,6,0,0],[0,0,0,6,0,7,2,2,2,2,7,0,6,0,0,0],[0,0,0,0,0,0,7,7,7,7,0,0,0,0,0,0],[0,0,0,0,0,0,6,0,0,6,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{name:"ã‚­ãƒã‚³",data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,7,7,7,7,7,7,7,7,0,0,0,0],[0,0,0,7,6,6,4,6,6,4,6,6,7,0,0,0],[0,0,7,6,6,4,4,6,6,4,4,6,6,7,0,0],[0,7,6,6,6,6,6,6,6,6,6,6,6,6,7,0],[0,7,6,6,6,6,6,6,6,6,6,6,6,6,7,0],[0,0,7,7,7,7,7,7,7,7,7,7,7,7,0,0],[0,0,0,0,0,7,1,1,1,1,7,0,0,0,0,0],[0,0,0,0,0,7,1,1,1,1,7,0,0,0,0,0],[0,0,0,0,0,7,3,1,1,3,7,0,0,0,0,0],[0,0,0,0,0,7,1,1,1,1,7,0,0,0,0,0],[0,0,0,0,0,7,1,5,5,1,7,0,0,0,0,0],[0,0,0,0,0,7,2,1,1,2,7,0,0,0,0,0],[0,0,0,0,7,7,2,2,2,2,7,7,0,0,0,0],[0,0,0,0,0,6,0,0,0,0,6,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},{name:"ã»ã—",data:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,7,7,0,0,0,0,0,0,0],[0,0,0,0,0,0,7,4,4,7,0,0,0,0,0,0],[0,0,0,0,0,7,1,1,1,1,7,0,0,0,0,0],[0,0,0,0,0,7,1,1,1,1,7,0,0,0,0,0],[0,7,7,7,7,1,1,3,3,1,1,7,7,7,7,0],[0,0,7,4,1,1,1,3,3,1,1,1,4,7,0,0],[0,0,0,7,1,1,1,1,1,1,1,1,7,0,0,0],[0,0,0,7,1,1,1,5,5,1,1,1,7,0,0,0],[0,0,0,7,1,1,1,1,1,1,1,1,7,0,0,0],[0,0,7,1,1,1,1,1,1,1,1,1,1,7,0,0],[0,7,1,2,1,1,1,1,1,1,1,1,2,1,7,0],[0,7,2,0,7,2,1,1,1,1,2,7,0,2,7,0],[0,0,0,0,0,7,2,2,2,2,7,0,0,0,0,0],[0,0,0,0,0,0,7,0,0,7,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]}],H=[[null,"#6BCB77","#3A8C4F","#1A1A2E","#A8F0B8","#FF6B8A","#4AAD5C","#2D6B3A"],[null,"#FF8EC4","#CC5A90","#2D1F3D","#FFD1E8","#FFEB3B","#FF6BAF","#A8416D"],[null,"#60A5FA","#3B72C4","#1A1A3E","#A5D8FF","#FFD93D","#4A8CE8","#2A5A9E"],[null,"#C084FC","#8B5CC0","#1E1040","#E2C4FF","#FFD93D","#A855F7","#6B3FA0"],[null,"#EF4444","#B91C1C","#1A0A0A","#FCA5A5","#FBBF24","#F97316","#8B1A1A"],[null,"#FCD34D","#D4A017","#2D2000","#FEF3C7","#FF6B6B","#F59E0B","#A07810"],[null,"#2DD4BF","#0D9488","#0A2020","#99F6E4","#FF8EC4","#14B8A6","#0D6D65"],[null,"#FB923C","#C2660A","#2D1500","#FED7AA","#6BCB77","#F97316","#955008"],[null,"#A78BFA","#7C5CC4","#180E30","#DDD6FE","#FFD93D","#8B5CF6","#5B3D99"],[null,"#9CA3AF","#6B7280","#111827","#D1D5DB","#FBBF24","#6B7280","#374151"]],j=[null,"wink","angry","sparkle","closed"],Le={3:[(e,t)=>{d(e,1,6,6),d(e,1,9,6),d(e,0,7,6),d(e,0,8,6)}],4:[(e,t)=>{d(e,1,6,6),d(e,1,9,6),d(e,0,7,6),d(e,0,8,6),d(e,6,0,6),d(e,7,0,6),d(e,6,15,6),d(e,7,15,6)}],5:[(e,t)=>{d(e,0,6,6),d(e,0,7,6),d(e,0,8,6),d(e,0,9,6),d(e,1,5,6),d(e,1,10,6),d(e,5,0,6),d(e,6,0,6),d(e,7,0,6),d(e,8,0,6),d(e,5,15,6),d(e,6,15,6),d(e,7,15,6),d(e,8,15,6),d(e,6,1,6),d(e,6,14,6)}]};function d(e,t,a,n){t>=0&&t<16&&a>=0&&a<16&&e[t][a]===0&&(e[t][a]=n)}function Ie(e,t){if(!t)return;const a=[];for(let n=0;n<16;n++)for(let o=0;o<16;o++)e[n][o]===3&&a.push([n,o]);if(a.length!==0)switch(t){case"wink":if(a.length>=2){const n=a.sort((o,c)=>o[1]-c[1])[0];e[n[0]][n[1]]=5}break;case"angry":for(const[n,o]of a)n>0&&e[n-1][o]!==7&&(e[n-1][o]=7);break;case"sparkle":for(const[n,o]of a)o>0&&e[n][o-1]===1&&(e[n][o-1]=4),n>0&&e[n-1][o]===1&&(e[n-1][o]=4);break;case"closed":for(const[n,o]of a)e[n][o]=7,n+1<16&&e[n+1][o]===1&&(e[n+1][o]=1);break}}function Te(e){let t=5381;for(let a=0;a<e.length;a++)t=(t<<5)+t+e.charCodeAt(a)|0;return Math.abs(t)}function _(e,t,a){const n=Te(e),o=n%$.length,c=(n>>4)%H.length,s=(n>>8)%j.length,l=o*10+c+1;return{bodyIdx:o,paletteIdx:c,faceIdx:s,dexNumber:l,level:t,branch:a}}function J(e,t,a=0){const n=e.canvas,o=$[t.bodyIdx%$.length],c=H[t.paletteIdx%H.length],s=o.data.map(m=>[...m]),l=j[t.faceIdx%j.length];Ie(s,l);const i=Le[t.level];if(i){const m=i[0];m&&m(s,c)}const u=16,p=Math.floor(Math.min(n.width,n.height)/u),f=Math.floor((n.width-p*u)/2),y=Math.sin(a*.1)*p*.4,C=Math.floor((n.height-p*u)/2+y);e.clearRect(0,0,n.width,n.height);const D=.12+Math.sin(a*.1)*.04;e.fillStyle=`rgba(0,0,0,${D})`,e.beginPath(),e.ellipse(n.width/2,n.height/2+p*u*.45,p*u*.3,p*.8,0,0,Math.PI*2),e.fill();for(let m=0;m<u;m++)for(let g=0;g<u;g++){const x=s[m][g];if(x===0)continue;const B=c[x];B&&(e.fillStyle=B,e.fillRect(f+g*p,C+m*p,p,p))}const h=a%120;if(h>=0&&h<4)for(let m=0;m<u;m++)for(let g=0;g<u;g++)s[m][g]===3&&(e.fillStyle=c[1]||"#fff",e.fillRect(f+g*p,C+m*p,p,p))}function $e(e,t=0){const a=e.canvas,n=$[0],o=[null,"#B0B8C4","#7A8290","#2D2D40","#D4DAE2","#FBBF24","#8892A0","#515A68"],c=n.data.map(f=>[...f]),s=16,l=Math.floor(Math.min(a.width,a.height)/s),i=Math.floor((a.width-l*s)/2),u=Math.sin(t*.08+1)*l*.3,p=Math.floor((a.height-l*s)/2+u);e.clearRect(0,0,a.width,a.height);for(let f=0;f<s;f++)for(let y=0;y<s;y++){const C=c[f][y];C!==0&&(e.fillStyle=o[C]||"#888",e.fillRect(i+y*l,p+f*l,l,l))}}function Fe(e,t){const{width:a,height:n}=e.canvas,o=a/2,c=n/2,s=12,l=Math.max(a,n);e.save(),e.globalAlpha=1-t;for(let p=0;p<s;p++){const f=p/s*Math.PI*2+t*Math.PI,y=.05+t*.15;e.beginPath(),e.moveTo(o,c),e.lineTo(o+Math.cos(f-y)*l*t,c+Math.sin(f-y)*l*t),e.lineTo(o+Math.cos(f+y)*l*t,c+Math.sin(f+y)*l*t),e.closePath(),e.fillStyle=`hsl(${(p*360/s+t*360)%360}, 80%, 70%)`,e.fill()}const i=l*.3*(1-Math.abs(t-.5)*2),u=e.createRadialGradient(o,c,0,o,c,i);u.addColorStop(0,`rgba(255,255,255,${.8*(1-t)})`),u.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=u,e.fillRect(0,0,a,n),e.restore()}const we="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent",X={name:"ã‚°ãƒ¬ãƒ¢ãƒ",personalitySummary:"ã®ã‚“ã³ã‚Šå±‹ã§å¥½å¥‡å¿ƒæ—ºç››ã€‚ã¡ã‚‡ã£ã¨å¤©ç„¶"};function z(e){if(!e)return"ã‚†ã‚‹ãã¦ã®ã‚“ããªè©±ã—æ–¹";const t=Object.entries(e).sort(([,c],[,s])=>s-c).filter(([,c])=>c>0);if(t.length===0)return"ã‚†ã‚‹ãã¦ã®ã‚“ããªè©±ã—æ–¹";const a=t[0][0];let o={creative:"å¤¢è¦‹ãŒã¡ã§ãµã‚ãµã‚ã—ãŸè©±ã—æ–¹ã€‚ã€Œã€œã‹ã‚‚ã€ã€Œã€œã£ã¦ç´ æ•µã€ãŒå£ç™–ã€‚è‰²ã‚„éŸ³ã®è¡¨ç¾ã‚’ä½¿ã†",physical:"å…ƒæ°—ã§ãƒ†ãƒ³ã‚·ãƒ§ãƒ³é«˜ã‚ã€‚ã€Œã‚ˆã£ã—ã‚ƒï¼ã€ã€Œã„ã£ã¡ã‚‡ã‚„ã‚‹ã‹ï¼ã€ãŒå£ç™–ã€‚ä½“ã®æ„Ÿè¦šã§ç‰©äº‹ã‚’è¡¨ç¾",social:"äººæ‡ã£ã“ãã¦ãŠã—ã‚ƒã¹ã‚Šå¥½ãã€‚ã€Œã­ãˆã­ãˆã€ã€Œã€œã ã‚ˆã­ï¼ã€ãŒå£ç™–ã€‚ç›¸æ‰‹ã®ã“ã¨ã‚’ã‚ˆãèã",intellectual:"è½ã¡ç€ã„ã¦ã„ã¦å°‘ã—å¤§äººã³ãŸè©±ã—æ–¹ã€‚ã€Œãªã‚‹ã»ã©ã€ã€Œèˆˆå‘³æ·±ã„ã€ãŒå£ç™–ã€‚ç†ç”±ã‚„ä»•çµ„ã¿ã‚’èªã‚ŠãŸãŒã‚‹",chaotic:"è‡ªç”±å¥”æ”¾ã§ã¤ã‹ã¿ã©ã“ã‚ãŒãªã„ã€‚ã€Œãªã‚“ã‹ã•ã€œã€ã€Œã‚ã¯ã¯ï¼ã€ãŒå£ç™–ã€‚è©±é¡ŒãŒé£›ã¶"}[a]||"ã‚†ã‚‹ã„è©±ã—æ–¹";if(t.length>=2){const c=t[1][0];o+=`ã€‚${{creative:"ãŸã¾ã«æƒ³åƒåŠ›è±Šã‹ãªã“ã¨ã‚’è¨€ã†",physical:"ãŸã¾ã«ä½“ã‚’å‹•ã‹ã—ãŸãŒã‚‹",social:"ãŸã¾ã«ç›¸æ‰‹ã‚’æ°—é£ã†",intellectual:"ãŸã¾ã«è±†çŸ¥è­˜ã‚’æŒŸã‚€",chaotic:"ãŸã¾ã«çªæ‹å­ã‚‚ãªã„ã“ã¨ã‚’è¨€ã†"}[c]}`}return o}function le(){const e=new Date().getHours();return e>=5&&e<11?"morning":e>=11&&e<15?"afternoon":e>=15&&e<19?"evening":"night"}function Ne(){const e=le();return{morning:"æœã®æŒ¨æ‹¶ã‚„ä»Šæ—¥ã®äºˆå®šã®è©±é¡Œ",afternoon:"ãŠæ˜¼ã”ã¯ã‚“ã‚„åˆå¾Œã®æ´»å‹•ã®è©±é¡Œ",evening:"å¤•æ–¹ã®ç–²ã‚Œã‚„ä»Šæ—¥ã‚ã£ãŸã“ã¨ã®æŒ¯ã‚Šè¿”ã‚Š",night:"å¤œã®ã¾ã£ãŸã‚Šã—ãŸé›°å›²æ°—ã€ãŠã‚„ã™ã¿å‰ã®è©±é¡Œ"}[e]}function Oe(e){return!e||e.length===0?"ã¾ã ä½•ã‚‚ã—ã¦ãªã„":e.slice(0,5).join("ã€")}function M(e){const t=Object.entries(e||{}).sort(([,i],[,u])=>u-i).filter(([,i])=>i>0),a=t.length>0?t[0][0]:"social",n=le(),o={creative:{morning:[{player:"ãŠã¯ã‚ˆã€‚ã‘ã•ã®ç©ºã„ã„è‰²ã ã£ãŸ",npc:"ã»ã‚“ã¨ï¼Ÿã©ã‚“ãªè‰²ï¼Ÿæ•™ãˆã¦æ•™ãˆã¦"},{player:"ã‚†ã‚ã®ä¸­ã§çµµã‚’æã„ã¦ãŸã‚ˆ",npc:"ã„ã„ãªã‚ã€èµ·ãã¦ã‚‚æã„ã¦ã‚ˆ"}],afternoon:[{player:"ãªã‚“ã‹æããŸã„æ°—åˆ†ã ãªã‚",npc:"ã¼ãã®ã“ã¨æã„ã¦ï¼ã‹ã‚ã„ãã—ã¦ã­"},{player:"ä»Šæ—¥ã®é›²ãŠã‚‚ã—ã‚ã„å½¢ã—ã¦ã‚‹",npc:"ã‚ã‚Œæç«œã«è¦‹ãˆã‚‹ï¼è¦‹ãˆã‚‹ï¼Ÿ"}],evening:[{player:"å¤•ç„¼ã‘ãŒãã‚Œã„ã ãªã‚",npc:"ã‚ªãƒ¬ãƒ³ã‚¸ã¨ç´«ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã ã­"},{player:"ãã‚‡ã†ä½œã£ãŸã‚‚ã®è¦‹ã¦ã€œ",npc:"ã‚ã‚ï¼ã™ã”ã„ãã‚Œã„ã ã­"}],night:[{player:"å¤œã£ã¦å‰µä½œã¯ã‹ã©ã‚‹ã‚ˆã­",npc:"ã‚ã‹ã‚‹ã€‚é™ã‹ã§é›†ä¸­ã§ãã‚‹ã‚ˆã­"},{player:"æ˜Ÿã£ã¦ã‚ˆãè¦‹ã‚‹ã¨ãã‚‰ãã‚‰ã ã­",npc:"æã„ã¦ã¿ãŸã‚‰ï¼Ÿãã£ã¨ç´ æ•µã ã‚ˆ"}]},physical:{morning:[{player:"ã‚ˆã—ã€æœã‹ã‚‰å‹•ããï¼",npc:"ã„ã„ã­ï¼ä¸€ç·’ã«èµ°ã‚‹ï¼Ÿ"},{player:"æœã®ã‚¹ãƒˆãƒ¬ãƒƒãƒæ°—æŒã¡ã„ã„ã€œ",npc:"ã¼ãã‚‚ã‚„ã‚‹ï¼ãããƒ¼ã£ã¨ã­"}],afternoon:[{player:"ãŠæ˜¼é£Ÿã¹ãŸã—å‹•ã“ã†ã‹ãª",npc:"æ•£æ­©ã„ã“ã†ã‚ˆï¼å¤©æ°—ã„ã„ã—"},{player:"ãã‚‡ã†ã‚ã£ã¡ã‚ƒèµ°ã£ãŸã‚ˆï¼",npc:"ã™ã”ã„ï¼ä½•ã‚­ãƒ­ï¼Ÿãˆã‚‰ã„ï¼"}],evening:[{player:"ç­‹è‚‰ç—›â€¦ã§ã‚‚æ°—æŒã¡ã„ã„",npc:"ãŒã‚“ã°ã£ãŸè¨¼æ‹ ã ã‚ˆï¼ãˆã‚‰ã„ï¼"},{player:"ä»Šæ—¥ã‚‚ã„ã„æ±—ã‹ã„ãŸãªã‚",npc:"ãŠç–²ã‚Œï¼ã”è¤’ç¾ãªã«é£Ÿã¹ã‚‹ï¼Ÿ"}],night:[{player:"ã‚ã—ãŸã‚‚æœã‹ã‚‰ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°",npc:"ã‚„ã‚‹ãªã‚ï¼ã¼ãã¯å¿œæ´ã™ã‚‹ã­"},{player:"ä»Šæ—¥ã¯æ—©ãå¯ã¦å›å¾©ã™ã‚‹ã‹",npc:"ä¼‘ã‚€ã®ã‚‚ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã ã‚ˆã­"}]},social:{morning:[{player:"ãŠã¯ã‚ˆï¼ãã‚‡ã†ã¯èª°ã«ä¼šãˆã‚‹ï¼Ÿ",npc:"ã¼ããŒã“ã“ã«ã„ã‚‹ã‚ˆã€œ"},{player:"ãã‚‡ã†ã¯å‹é”ã¨ä¼šã†ç´„æŸï¼",npc:"ã„ã„ãªã‚ï¼æ¥½ã—ã‚“ã§ãã¦ã­"}],afternoon:[{player:"ã¿ã‚“ãªã§ãŠæ˜¼é£Ÿã¹ãŸã‚ˆã€œ",npc:"ãªã«é£Ÿã¹ãŸã®ï¼ŸãŠã„ã—ã‹ã£ãŸï¼Ÿ"},{player:"ãŠã—ã‚ƒã¹ã‚Šã£ã¦æ¥½ã—ã„ã­",npc:"ã­ãƒ¼ï¼ã‚‚ã£ã¨è©±ãã†ã‚ˆï¼"}],evening:[{player:"ä»Šæ—¥ã¯ã„ã„1æ—¥ã ã£ãŸãªã‚",npc:"ã‚ˆã‹ã£ãŸã­ï¼ä½•ãŒæ¥½ã—ã‹ã£ãŸï¼Ÿ"},{player:"ã¾ã å¸°ã‚ŠãŸããªã„ãªã‚",npc:"ã˜ã‚ƒã‚ã‚‚ã†ã¡ã‚‡ã£ã¨ã ã‘ã­"}],night:[{player:"ãã‚‡ã†ã‚‚æ¥½ã—ã‹ã£ãŸãƒ¼",npc:"ã¼ãã‚‚æ¥½ã—ã‹ã£ãŸï¼ãŠã‚„ã™ã¿ã€œ"},{player:"ã‚ã—ãŸã‚‚ã¿ã‚“ãªã«ä¼šã„ãŸã„ãª",npc:"ãã£ã¨ä¼šãˆã‚‹ã‚ˆï¼æ¥½ã—ã¿ã ã­"}]},intellectual:{morning:[{player:"ãã‚‡ã†ã¯ä½•ã‚’å­¦ã¼ã†ã‹ãª",npc:"ãŠã™ã™ã‚ã®æœ¬ã‚ã‚‹ã‚ˆã€èª­ã‚€ï¼Ÿ"},{player:"æœã®èª­æ›¸ã¯é›†ä¸­ã§ãã¦ã„ã„ã­",npc:"é™ã‹ãªæ™‚é–“ã£ã¦è²´é‡ã ã‚ˆã­"}],afternoon:[{player:"é¢ç™½ã„ç™ºè¦‹ãŒã‚ã£ãŸã‚“ã ",npc:"ã¸ãˆï¼ãã‚ã—ãèã‹ã›ã¦"},{player:"å‹‰å¼·ã£ã¦ã‚„ã‚Šå§‹ã‚ã‚‹ã¨æ¥½ã—ã„",npc:"åˆ†ã‹ã‚‹ã€‚æ­¢ã¾ã‚‰ãªããªã‚‹ã‚ˆã­"}],evening:[{player:"ãã‚‡ã†çŸ¥ã£ãŸã“ã¨æ•´ç†ã—ãŸã„",npc:"ãƒ¡ãƒ¢ã—ã¦ãŠãã¨ã„ã„ã‹ã‚‚ã­"},{player:"ã‚ã®ä»•çµ„ã¿ãŒé¢ç™½ã‹ã£ãŸ",npc:"ã©ã†ã‚„ã£ã¦å‹•ã„ã¦ã‚‹ã®ï¼Ÿ"}],night:[{player:"å¯ã‚‹å‰ã«å°‘ã—èª­æ›¸ã—ã‚ˆã†ã‹ãª",npc:"èª­ã¿ã™ãã¦å¤œãµã‹ã—ã«æ³¨æ„ã ã‚ˆ"},{player:"çŸ¥ã‚‰ãªã„ã“ã¨ãŒã¾ã å¤šã„ãª",npc:"ã ã‹ã‚‰æ¯æ—¥ãŒé¢ç™½ã„ã‚“ã ã‚ˆã­"}]},chaotic:{morning:[{player:"æœã‹ã‚‰ãªã‚“ã‹å¤‰ãªã“ã¨ã—ãŸã„",npc:"ã„ã„ã­ï¼ä½•ã™ã‚‹ï¼Ÿå·»ãè¾¼ã‚“ã§ï¼"},{player:"ã‚†ã‚ãŒæ„å‘³ã‚ã‹ã‚‰ã‚“ã‹ã£ãŸ",npc:"ã‚ã¯ã¯ï¼ãã‚Œæœ€é«˜ã ã­"}],afternoon:[{player:"ãªã‚“ã‹é¢ç™½ã„ã“ã¨ãªã„ã‹ãª",npc:"é€†ç«‹ã¡ã—ã¦ãŠæ˜¼é£Ÿã¹ã‚‹ã¨ã‹ï¼Ÿ"},{player:"é€€å±ˆã£ã¦ã‚ã‚‹æ„å‘³ã™ã”ã„ã‚ˆã­",npc:"é€€å±ˆã‚’ã¶ã£å£Šã™æ–¹æ³•è€ƒãˆã‚ˆã†ï¼"}],evening:[{player:"ãã‚‡ã†ã‚‚ã‚«ã‚ªã‚¹ã ã£ãŸãªã‚",npc:"ãã‚ŒãŒä¸€ç•ªæ¥½ã—ã„ã˜ã‚ƒã‚“ï¼"},{player:"ã•ã£ãå¤‰ãªã‚‚ã®è¦‹ã¤ã‘ãŸ",npc:"è¦‹ã›ã¦è¦‹ã›ã¦ï¼æ°—ã«ãªã‚‹ï¼"}],night:[{player:"å¤œä¸­ã®ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã£ã¦ã‚„ã°ã„",npc:"åˆ†ã‹ã‚‹ï¼ãªã‚“ã‹ç„¡æ•µãªæ°—åˆ†"},{player:"ã‚ã—ãŸä½•ãŒèµ·ã“ã‚‹ã‹æ¥½ã—ã¿",npc:"ä½•ã«ã‚‚æ±ºã‚ãªã„ã®ãŒæœ€é«˜ã ã‚ˆã­"}]}},c=o[a]||o.social,s=c[n]||c.afternoon,l=Math.floor(Math.random()*s.length);return{...s[l]}}async function Re(e,t,a,n,o=[]){var p,f,y,C,D;if(!e){const h=M(a);return{messages:[{speaker:"player",text:h.player},{speaker:"npc",text:h.npc}]}}const c=z(a),s=Oe(n),l=Ne();let i;if(o.length>0){const h=o[Math.floor(Math.random()*o.length)];i={name:h.name,tone:z(h.personality),desc:h.personalitySummary||"ãµã—ããªã‚„ã¤"}}else i={name:X.name,tone:"ã®ã‚“ã³ã‚Šå±‹ã§å¤©ç„¶ã€‚ã€Œã€œã ã‚ˆã€œã€ãŒå£ç™–",desc:X.personalitySummary};const u=`ã‚ãªãŸã¯2ä½“ã®ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã®ã‚†ã‚‹ã„æ—¥å¸¸ä¼šè©±ã‚’æ›¸ããƒ©ã‚¤ã‚¿ãƒ¼ã§ã™ã€‚
ãã‚Œãã‚Œã®æ€§æ ¼ã«åˆã£ãŸã€ãƒ†ãƒ³ãƒ—ãƒ¬æ„Ÿã®ãªã„è‡ªç„¶ãªä¼šè©±ã‚’1å¾€å¾©æ›¸ã„ã¦ãã ã•ã„ã€‚

ã€${t.name}ã€‘(Lv${t.level})
- å£èª¿: ${c}
- æœ€è¿‘ã‚„ã£ãŸã“ã¨: ${s}

ã€${i.name}ã€‘
- å£èª¿: ${i.tone}
- æ€§æ ¼: ${i.desc}

ã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³: ${l}

å¿…é ˆãƒ«ãƒ¼ãƒ«:
- å„ã‚»ãƒªãƒ•30æ–‡å­—ä»¥å†…
- ã²ã‚‰ãŒãªå¤šã‚
- ${t.name}ã¯æœ€è¿‘ã‚„ã£ãŸã“ã¨ã®è©±é¡Œã‚’çµ¡ã‚ã‚‹
- æ¯å›é•ã†è©±é¡Œã¨è¨€ã„å›ã—ã€‚ãƒ†ãƒ³ãƒ—ãƒ¬ã£ã½ã•ã‚’æ’é™¤
- ç›´å‰ã®ä¼šè©±ã¨åŒã˜å†…å®¹ã«ã—ãªã„
- çµµæ–‡å­—ãƒ»é¡”æ–‡å­—ã¯ç¦æ­¢
- JSONå‡ºåŠ›ã®ã¿: {"player":"ã‚»ãƒªãƒ•","npc":"ã‚»ãƒªãƒ•"}`;try{const h=await fetch(`${we}?key=${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:u}]}],generationConfig:{temperature:1.1,maxOutputTokens:200}})});if(!h.ok){console.warn("Gemini APIå¿œç­”ã‚¨ãƒ©ãƒ¼:",h.status);const A=M(a);return{messages:[{speaker:"player",text:A.player},{speaker:"npc",text:A.npc,speakerName:i.name}]}}const x=(((D=(C=(y=(f=(p=(await h.json()).candidates)==null?void 0:p[0])==null?void 0:f.content)==null?void 0:y.parts)==null?void 0:C[0])==null?void 0:D.text)||"").match(/\{[\s\S]*?\}/);if(x){const A=JSON.parse(x[0]);if(A.player&&A.npc)return{messages:[{speaker:"player",text:A.player},{speaker:"npc",text:A.npc,speakerName:i.name}]}}const B=M(a);return{messages:[{speaker:"player",text:B.player},{speaker:"npc",text:B.npc}]}}catch(h){console.warn("Gemini APIå‘¼ã³å‡ºã—å¤±æ•—:",h);const m=M(a);return{messages:[{speaker:"player",text:m.player},{speaker:"npc",text:m.npc}]}}}let R=null,E=!1;function ie(){return R||(R=new(window.AudioContext||window.webkitAudioContext)),R}function W(){return E}function Pe(){return E=!E,E}function He(e){E=e}function v(e,t,a=0,n=.15,o="sine"){if(E)return;const c=ie(),s=c.createOscillator(),l=c.createGain();s.type=o,s.frequency.value=e,l.gain.setValueAtTime(n,c.currentTime+a),l.gain.exponentialRampToValueAtTime(.001,c.currentTime+a+t),s.connect(l),l.connect(c.destination),s.start(c.currentTime+a),s.stop(c.currentTime+a+t)}function je(){if(!E)try{v(523.25,.12,0,.18,"sine"),v(659.25,.12,.08,.18,"sine"),v(783.99,.2,.16,.15,"sine")}catch{}}function _e(){if(!E)try{v(523.25,.1,0,.12,"square"),v(659.25,.1,.1,.12,"square"),v(783.99,.1,.2,.12,"square"),v(1046.5,.3,.3,.15,"sine"),v(783.99,.1,.5,.08,"sine"),v(1046.5,.4,.6,.12,"sine")}catch{}}function qe(){if(!E)try{const e=ie(),t=e.createOscillator(),a=e.createGain();t.type="sine",t.frequency.setValueAtTime(800,e.currentTime),t.frequency.exponentialRampToValueAtTime(400,e.currentTime+.08),a.gain.setValueAtTime(.1,e.currentTime),a.gain.exponentialRampToValueAtTime(.001,e.currentTime+.1),t.connect(a),a.connect(e.destination),t.start(),t.stop(e.currentTime+.1)}catch{}}let r=null,L=!1,F="today",I=0;const Q=6,Ye=30;function Ve(){r=oe(),r=me(r),b(r),localStorage.getItem("todo-monster-muted")==="true"&&He(!0),Ke(),k(),V(),G(),K(),w(),Ge(),de()}function Ge(){const e=document.getElementById("char-canvas"),t=document.getElementById("npc-canvas");function a(){I++;const n=e.getContext("2d"),o=_(r.character.name,r.character.level,r.character.branch);J(n,o,I);const c=t.getContext("2d");if(r.friends.length>0){const s=r.friends[0],l=_(s.name,s.level||2,s.branch||null);J(c,l,I)}else $e(c,I);requestAnimationFrame(a)}a()}function Ke(){document.getElementById("todo-form").addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("todo-input"),a=t.value.trim();if(!a)return;const n=a.includes("ğŸ”")||a.startsWith("æ¯æ—¥"),o=a.replace("ğŸ”","").replace(/^æ¯æ—¥\s*/,"").trim(),s={yesterday:q(),today:S(),tomorrow:Y()}[F]||S(),l=ye(o||a,s,n);r.todos.unshift(l),b(r),t.value="",k()}),document.querySelectorAll(".date-tab").forEach(e=>{e.addEventListener("click",()=>{F=e.dataset.date,document.querySelectorAll(".date-tab").forEach(t=>t.classList.remove("active")),e.classList.add("active"),k()})}),document.getElementById("api-key-btn").addEventListener("click",()=>{document.getElementById("api-key-input").value=r.apiKey||"",document.getElementById("api-modal").classList.add("show")}),document.getElementById("api-save-btn").addEventListener("click",()=>{r.apiKey=document.getElementById("api-key-input").value.trim(),b(r),document.getElementById("api-modal").classList.remove("show"),Z()}),document.getElementById("api-cancel-btn").addEventListener("click",()=>{document.getElementById("api-modal").classList.remove("show")}),document.getElementById("reset-btn").addEventListener("click",()=>{confirm("å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ")&&(localStorage.removeItem("todo-monster-data"),r=oe(),k(),V(),G(),K(),w())}),document.getElementById("chat-trigger-btn").addEventListener("click",()=>et()),document.getElementById("export-btn").addEventListener("click",Ue),document.getElementById("import-btn").addEventListener("click",()=>{document.getElementById("friend-modal").classList.add("show")}),document.getElementById("friend-save-btn").addEventListener("click",Je),document.getElementById("friend-cancel-btn").addEventListener("click",()=>{document.getElementById("friend-modal").classList.remove("show")}),document.getElementById("mute-btn").addEventListener("click",()=>{const e=Pe();localStorage.setItem("todo-monster-muted",e),de()}),document.getElementById("history-btn").addEventListener("click",()=>{tt(),document.getElementById("history-modal").classList.add("show")}),document.getElementById("history-close-btn").addEventListener("click",()=>{document.getElementById("history-modal").classList.remove("show")}),Z()}function Z(){const e=document.getElementById("api-status");r.apiKey?(e.textContent="ğŸŸ¢ Geminiæ¥ç¶šæ¸ˆã¿",e.className="api-status connected"):(e.textContent="âšª ãƒ¢ãƒƒã‚¯ä¼šè©±ãƒ¢ãƒ¼ãƒ‰",e.className="api-status disconnected")}function de(){const e=document.getElementById("mute-btn");e.textContent=W()?"ğŸ”‡":"ğŸ”Š",e.title=W()?"éŸ³ã‚’ã‚ªãƒ³ã«ã™ã‚‹":"éŸ³ã‚’ã‚ªãƒ•ã«ã™ã‚‹"}function Ue(){const e={id:r.character.name+"_"+Date.now().toString(36),name:r.character.name,level:r.character.level,branch:r.character.branch,personalitySummary:ce(r.personality),personality:r.personality},t=btoa(unescape(encodeURIComponent(JSON.stringify(e))));navigator.clipboard.writeText(t).then(()=>{const a=document.getElementById("export-btn"),n=a.textContent;a.textContent="âœ… ã‚³ãƒ”ãƒ¼ã—ãŸï¼",setTimeout(()=>{a.textContent=n},2e3)}).catch(()=>prompt("ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’å‹é”ã«é€ã£ã¦ã­:",t))}function Je(){const e=document.getElementById("friend-code-input"),t=e.value.trim();if(t)try{const a=JSON.parse(decodeURIComponent(escape(atob(t))));if(!a.name||a.level===void 0){alert("ã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ããªã„ã¿ãŸã„â€¦");return}const n=r.friends.findIndex(c=>c.name===a.name),o={id:a.id||a.name+"_"+Date.now().toString(36),name:a.name,level:a.level,branch:a.branch||null,personalitySummary:a.personalitySummary||"ãµã—ããªã‚„ã¤",personality:a.personality||null};n>=0?r.friends[n]=o:r.friends.push(o),b(r),document.getElementById("friend-modal").classList.remove("show"),e.value="",w()}catch{alert("ã‚³ãƒ¼ãƒ‰ãŒèª­ã¿å–ã‚Œãªã‹ã£ãŸâ€¦")}}function Xe(e){r.friends.splice(e,1),b(r),w()}function w(){const e=document.getElementById("friend-list");if(e.innerHTML="",r.friends.length===0){e.innerHTML='<div class="friend-empty">ãƒ•ãƒ¬ãƒ³ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã¨ã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆ</div>';return}for(let t=0;t<r.friends.length;t++){const a=r.friends[t],n=document.createElement("div");n.className="friend-item",n.innerHTML=`
      <span class="friend-info"><strong>${N(a.name)}</strong> <span class="friend-level">Lv.${a.level}</span></span>
      <button class="friend-remove-btn" title="è§£é™¤">âœ•</button>`,n.querySelector(".friend-remove-btn").addEventListener("click",()=>Xe(t)),e.appendChild(n)}}function ze(){return{yesterday:q(),today:S(),tomorrow:Y()}[F]||S()}function k(){const e=document.getElementById("todo-list"),t=ze(),a=r.todos.filter(c=>c.scheduledDate===t),n=a.filter(c=>!c.completed),o=a.filter(c=>c.completed);if(e.innerHTML="",n.length===0&&o.length===0){const c={yesterday:"ãã®ã†ã®ã‚¿ã‚¹ã‚¯ã¯ãªã„ã‚ˆ",tomorrow:"ã‚ã—ãŸã®äºˆå®šã‚’æ›¸ãè¾¼ã‚‚ã†ï¼",today:"ã‚„ã‚ŠãŸã„ã“ã¨ã‚’è¿½åŠ ã—ã‚ˆã†ï¼"};e.innerHTML=`<div class="todo-empty">${c[F]||c.today}</div>`,ee(0);return}for(const c of n)e.appendChild(te(c,!1));if(o.length>0){const c=document.createElement("div");c.className="todo-separator",c.textContent=`âœ… å®Œäº†æ¸ˆã¿ï¼ˆ${o.length}ï¼‰`,c.addEventListener("click",()=>{document.getElementById("completed-list").classList.toggle("collapsed"),c.classList.toggle("collapsed")}),e.appendChild(c);const s=document.createElement("div");s.id="completed-list",s.className="completed-list";for(const l of o.slice(0,10))s.appendChild(te(l,!0));e.appendChild(s)}ee(n.length)}function ee(e){document.getElementById("todo-count").textContent=`${e}ä»¶ã®ã‚„ã‚ŠãŸã„ã“ã¨`}function te(e,t){const a=document.createElement("div");a.className=`todo-item${t?" completed":""}`,a.id=`todo-${e.id}`;const n=P(e.category),o=ge(e.category),c=e.isRecurring?'<span class="recurring-mark" title="æ¯æ—¥ã‚¿ã‚¹ã‚¯">ğŸ”</span>':"";return a.innerHTML=`
    <div class="todo-content">
      <span class="todo-category" title="${o}">${n}</span>
      <span class="todo-text">${N(e.text)}</span>${c}
    </div>
    <div class="todo-actions">
      ${t?"":'<button class="todo-complete-btn" title="å®Œäº†ï¼">âœ“</button>'}
      <button class="todo-delete-btn" title="å‰Šé™¤">Ã—</button>
    </div>`,t||a.querySelector(".todo-complete-btn").addEventListener("click",()=>We(e.id)),a.querySelector(".todo-delete-btn").addEventListener("click",()=>Ze(e.id)),a}function We(e){const t=r.todos.find(n=>n.id===e);if(!t||t.completed)return;const a=document.getElementById(`todo-${e}`);a&&(a.classList.add("completing"),Qe(a)),je(),setTimeout(()=>{t.completed=!0,t.completedAt=Date.now(),r.personality=ve(r.personality,t.category);const n=Me(r.character,r.personality,se);r.character=n.character,b(r),k(),V(),G(),n.evolved&&n.newStageName&&(_e(),nt(n.newStageName))},500)}function Qe(e){const t=e.getBoundingClientRect(),a=t.left+t.width/2,n=t.top+t.height/2,o=["#ff6ec7","#9b5de5","#f9c74f","#00bbf9","#00f5d4","#ff6b6b"];for(let c=0;c<12;c++){const s=document.createElement("div");s.className="particle",s.style.left=a+"px",s.style.top=n+"px",s.style.background=o[Math.floor(Math.random()*o.length)];const l=Math.PI*2*c/12+Math.random()*.5,i=40+Math.random()*60;s.style.setProperty("--dx",`${Math.cos(l)*i}px`),s.style.setProperty("--dy",`${Math.sin(l)*i}px`),document.body.appendChild(s),setTimeout(()=>s.remove(),600)}}function Ze(e){r.todos=r.todos.filter(t=>t.id!==e),b(r),k()}function V(){document.getElementById("char-name").textContent=r.character.name,document.getElementById("char-level").textContent=`Lv.${r.character.level}`,document.getElementById("char-stage").textContent=re(r.character);const e=document.getElementById("char-branch");r.character.branch?(e.textContent=xe(r.character.branch),e.style.display="block"):e.style.display="none";const t=De(r.character);document.getElementById("exp-bar-fill").style.width=`${t*100}%`,document.getElementById("exp-text").textContent=r.character.level>=5?"MAX!":`ã‚ã¨${Be(r.character)}ã‚¿ã‚¹ã‚¯ã§é€²åŒ–`;const a=_(r.character.name,r.character.level,r.character.branch),n=document.getElementById("char-dex");n&&(n.textContent=`No.${String(a.dexNumber).padStart(3,"0")}`)}function G(){document.getElementById("personality-summary").textContent=ce(r.personality);const e=document.getElementById("personality-bars"),t=[{key:"creative",label:"ğŸ¨ ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–",color:"#ff6ec7"},{key:"physical",label:"ğŸ’ª ãƒ•ã‚£ã‚¸ã‚«ãƒ«",color:"#ef4444"},{key:"social",label:"ğŸ—£ï¸ ã‚½ãƒ¼ã‚·ãƒ£ãƒ«",color:"#fbbf24"},{key:"intellectual",label:"ğŸ“š ã‚¤ãƒ³ãƒ†ãƒ¬ã‚¯ãƒãƒ¥ã‚¢ãƒ«",color:"#818cf8"},{key:"chaotic",label:"ğŸ‰ ã‚«ã‚ªã‚¹",color:"#e879f9"}];e.innerHTML="";const a=Math.max(1,...Object.values(r.personality));for(const n of t){const o=r.personality[n.key]||0,c=o/a*100,s=document.createElement("div");s.className="trait-bar",s.innerHTML=`<span class="trait-label">${n.label}</span><div class="trait-meter"><div class="trait-fill" style="width:${c}%;background:${n.color}"></div></div><span class="trait-value">${o}</span>`,e.appendChild(s)}}function K(){const e=document.getElementById("chat-log"),t=document.getElementById("chat-toggle-btn");if(e.innerHTML="",r.chatLog.length===0){e.innerHTML='<div class="chat-empty">ã‚¿ã‚¹ã‚¯ã‚’å®Œäº†ã™ã‚‹ã¨ã‚­ãƒ£ãƒ©ãŒè©±ã—å§‹ã‚ã‚‹ã‚ˆ</div>',t&&(t.style.display="none");return}const a=L?Ye:Q,n=r.chatLog.slice(-a).reverse();for(const o of n){const c=document.createElement("div");c.className=`chat-bubble ${o.speaker==="player"?"chat-player":"chat-npc"}`;const s=o.speaker==="player"?r.character.name:o.speakerName||pe();c.innerHTML=`<span class="chat-speaker">${s}</span><span class="chat-message">${N(o.message)}</span>`,e.appendChild(c)}t&&(r.chatLog.length>Q?(t.style.display="block",t.textContent=L?"â–² é–‰ã˜ã‚‹":`â–¼ ã‚‚ã£ã¨è¦‹ã‚‹ï¼ˆ${r.chatLog.length}ä»¶ï¼‰`,t.onclick=()=>{L=!L,K()}):t.style.display="none")}function pe(){return r.friends.length>0?r.friends[0].name:"ã‚°ãƒ¬ãƒ¢ãƒ"}function ne(e){const t=document.getElementById("chat-log"),a=t.querySelector(".chat-empty");a&&a.remove();const n=document.createElement("div");n.className=`chat-bubble ${e.speaker==="player"?"chat-player":"chat-npc"} chat-entering`;const o=e.speaker==="player"?r.character.name:e.speakerName||pe();n.innerHTML=`<span class="chat-speaker">${o}</span><span class="chat-message"></span>`,t.prepend(n),qe(),requestAnimationFrame(()=>{n.classList.remove("chat-entering"),n.classList.add("chat-pop-in")});const c=n.querySelector(".chat-message");let s=0;const l=setInterval(()=>{s++,c.textContent=e.message.slice(0,s),s>=e.message.length&&clearInterval(l)},35)}async function et(){const e=document.getElementById("chat-trigger-btn");e.disabled=!0,e.textContent="ğŸ”„ è€ƒãˆä¸­...";try{const t=r.todos.filter(o=>o.completed).sort((o,c)=>c.completedAt-o.completedAt).slice(0,5).map(o=>o.text),n=(await Re(r.apiKey,r.character,r.personality,t,r.friends)).messages;n.length>0&&(r.chatLog.push({speaker:n[0].speaker,message:n[0].text,speakerName:n[0].speakerName||null,timestamp:Date.now()}),ne({speaker:n[0].speaker,message:n[0].text,speakerName:n[0].speakerName||null})),n.length>1?setTimeout(()=>{r.chatLog.push({speaker:n[1].speaker,message:n[1].text,speakerName:n[1].speakerName||null,timestamp:Date.now()}),ne({speaker:n[1].speaker,message:n[1].text,speakerName:n[1].speakerName||null}),r.chatLog.length>60&&(r.chatLog=r.chatLog.slice(-60)),b(r)},1200):(r.chatLog.length>60&&(r.chatLog=r.chatLog.slice(-60)),b(r))}catch(t){console.error("ãƒãƒ£ãƒƒãƒˆç”Ÿæˆã‚¨ãƒ©ãƒ¼:",t)}finally{e.disabled=!1,e.textContent="ğŸ’¬ ãŠã—ã‚ƒã¹ã‚Šã•ã›ã‚‹"}}function tt(){const e=document.getElementById("history-body");e.innerHTML="";const t=r.todos.filter(n=>n.completed&&n.completedAt).sort((n,o)=>o.completedAt-n.completedAt);if(t.length===0){e.innerHTML='<div class="history-empty">ã¾ã å®Œäº†ã—ãŸã‚¿ã‚¹ã‚¯ãŒãªã„ã‚ˆ</div>';return}const a={};for(const n of t){const o=new Date(n.completedAt),c=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`;a[c]||(a[c]=[]),a[c].push(n)}for(const[n,o]of Object.entries(a)){const c=document.createElement("div");c.className="history-group";const s={};for(const i of o)s[i.category]=(s[i.category]||0)+1;const l=Object.entries(s).map(([i,u])=>`<span class="history-badge">${P(i)}${u}</span>`).join("");c.innerHTML=`
      <div class="history-date"><span class="history-date-label">${ue(n)}</span><span class="history-date-str">${n}</span><span class="history-badges">${l}</span></div>
      <div class="history-tasks">${o.map(i=>`<div class="history-task">${P(i.category)} ${N(i.text)}</div>`).join("")}</div>`,e.appendChild(c)}}function nt(e){const t=document.getElementById("evolution-overlay"),a=document.getElementById("evolution-name");t.classList.add("show"),a.textContent="";const n=document.getElementById("evolution-canvas");if(n){const o=n.getContext("2d");let c=0;const s=()=>{c+=.015,c>1&&(c=1),Fe(o,c),c<1&&requestAnimationFrame(s)};s()}setTimeout(()=>{a.textContent=`âœ¨ ${e}ã«é€²åŒ–ï¼ âœ¨`,a.classList.add("show")},800),setTimeout(()=>{t.classList.remove("show"),a.classList.remove("show"),a.textContent=""},3500)}function N(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}Ve();
