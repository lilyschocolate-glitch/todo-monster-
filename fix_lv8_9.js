import fs from 'fs';

const NEW_MONSTER_DATA = {
    'lv8_siren': {
        palette: "[null, '#86efac', '#22c55e', '#000', '#fff', '#f472b6', '#3b82f6', '#166534', '#064e3b']",
        data: `[
            [0, 0, 5, 0, 5, 0, 5, 0, 5, 0, 5, 0, 0, 0, 0, 0], // 5=ピンクの桜吹雪/花びら
            [0, 5, 0, 0, 0, 5, 0, 0, 0, 5, 0, 5, 0, 0, 0, 0],
            [0, 0, 0, 8, 8, 8, 8, 8, 8, 8, 8, 0, 0, 0, 0, 0], // 緑の妖精・花の精霊
            [0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0], // 1=明るい緑
            [0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0],
            [0, 8, 1, 4, 3, 1, 1, 1, 1, 3, 4, 1, 8, 0, 0, 0], // 4=白, 3=黒(目)
            [0, 8, 1, 5, 5, 1, 1, 1, 1, 5, 5, 1, 8, 0, 0, 0], // 5=ピンクほっぺ
            [0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0],
            [0, 0, 0, 8, 1, 7, 7, 7, 7, 1, 8, 0, 0, 0, 0, 0], // 7=濃緑のドレス
            [0, 0, 8, 7, 2, 8, 4, 4, 8, 2, 7, 8, 0, 0, 0, 0], // 2=さらに濃い緑、4=胸の花
            [0, 8, 7, 2, 2, 8, 5, 5, 8, 2, 2, 7, 8, 0, 0, 0],
            [8, 7, 2, 2, 2, 2, 8, 8, 2, 2, 2, 2, 7, 8, 0, 0],
            [0, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 0, 0, 0], // フリル
            [0, 0, 1, 8, 0, 0, 0, 0, 0, 0, 1, 8, 0, 0, 0, 0], // 足
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv8_colossus': {
        palette: "[null, '#78350f', '#451a03', '#000', '#fff', '#fcd34d', '#fef08a', '#1e293b', '#0f172a']",
        data: `[
            [0, 0, 0, 0, 0, 8, 8, 8, 8, 8, 0, 0, 0, 0, 0, 0], // 古代の巨像
            [0, 0, 0, 0, 8, 7, 7, 7, 7, 7, 8, 0, 0, 0, 0, 0], // 7=金属光沢(黒鉄)または濃灰
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0], // 1=茶(錆びた岩)
            [0, 0, 8, 1, 1, 1, 5, 5, 5, 1, 1, 1, 8, 0, 0, 0], // 5=光る金色の目
            [0, 0, 8, 1, 1, 5, 6, 5, 6, 5, 1, 1, 8, 0, 0, 0], // 6=まばゆい光源白黄
            [0, 0, 8, 1, 1, 5, 5, 5, 5, 5, 1, 1, 8, 0, 0, 0],
            [0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0],
            [0, 8, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 8, 0, 0], // 2=濃い茶(肩や胸装甲)
            [8, 1, 1, 1, 2, 2, 7, 7, 7, 2, 2, 1, 1, 1, 8, 0], // 7=胸のコア金属
            [8, 1, 1, 2, 2, 7, 5, 6, 5, 7, 2, 2, 1, 1, 8, 0], // コア光源
            [8, 1, 1, 2, 2, 7, 7, 7, 7, 7, 2, 2, 1, 1, 8, 0],
            [0, 8, 8, 8, 2, 2, 2, 2, 2, 2, 2, 8, 8, 8, 0, 0],
            [0, 0, 0, 8, 8, 1, 1, 1, 1, 1, 8, 8, 0, 0, 0, 0],
            [0, 0, 0, 8, 2, 2, 8, 0, 8, 2, 2, 8, 0, 0, 0, 0], // どっしりした脚
            [0, 0, 0, 8, 2, 2, 8, 0, 8, 2, 2, 8, 0, 0, 0, 0],
            [0, 0, 0, 8, 8, 8, 8, 0, 8, 8, 8, 8, 0, 0, 0, 0]
        ]`
    },
    'lv8_wizard': {
        palette: "[null, '#38bdf8', '#0284c7', '#000', '#fff', '#e879f9', '#c084fc', '#1e3a8a', '#0f172a']",
        data: `[
            [0, 0, 0, 0, 0, 0, 0, 0, 8, 8, 0, 0, 0, 0, 0, 0], // とんがり帽子
            [0, 0, 0, 0, 0, 0, 0, 8, 7, 8, 0, 0, 0, 0, 0, 0], // 7=濃青
            [0, 0, 0, 0, 6, 0, 8, 7, 7, 7, 8, 0, 6, 0, 0, 0], // 6=紫(魔法エフェクト)
            [0, 0, 0, 6, 5, 0, 8, 7, 7, 7, 8, 0, 5, 6, 0, 0], // 5=ピンク紫
            [0, 0, 0, 0, 6, 8, 7, 7, 7, 7, 7, 8, 6, 0, 0, 0],
            [0, 0, 0, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 0, 0, 0], // 帽子のつば
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0], // 顔(1=メイン青)
            [0, 0, 0, 8, 1, 3, 4, 1, 1, 3, 4, 1, 8, 0, 0, 0], // 目(3=黒, 4=白瞳)
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0],
            [0, 0, 0, 8, 1, 4, 4, 4, 4, 4, 4, 1, 8, 0, 0, 0], // 立派な白髭
            [0, 0, 8, 2, 8, 4, 4, 4, 4, 4, 4, 8, 2, 8, 0, 0], // 服(2=さらに濃い紺)
            [0, 8, 2, 2, 2, 8, 4, 4, 4, 4, 8, 2, 2, 2, 8, 0],
            [0, 8, 2, 2, 2, 2, 8, 8, 8, 8, 2, 2, 2, 2, 8, 0],
            [0, 8, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 8, 0],
            [0, 0, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv8_gryphon': {
        palette: "[null, '#facc15', '#eab308', '#000', '#fff', '#fbbf24', '#f59e0b', '#dc2626', '#b91c1c']",
        data: `[
            [8, 8, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 8, 8, 0], // 猛禽のような巨大な翼の先(8=黒輪郭)
            [8, 4, 4, 8, 8, 0, 0, 0, 0, 0, 8, 8, 4, 4, 8, 0], // 4=白金の羽
            [0, 8, 4, 4, 1, 8, 0, 0, 0, 8, 1, 4, 4, 8, 0, 0], // 1=金の体
            [0, 0, 8, 1, 1, 1, 8, 8, 8, 1, 1, 1, 8, 0, 0, 0],
            [0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0],
            [0, 0, 8, 1, 3, 3, 1, 1, 1, 3, 3, 1, 8, 0, 0, 0], // 凛々しい黒目
            [0, 0, 8, 1, 3, 4, 1, 1, 1, 4, 3, 1, 8, 0, 0, 0], // 鋭いハイライト
            [0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0],
            [0, 0, 8, 1, 1, 8, 7, 7, 7, 8, 1, 1, 8, 0, 0, 0], // ワシのような赤いくちばし(7)
            [0, 0, 8, 1, 8, 7, 7, 4, 7, 7, 8, 1, 8, 0, 0, 0],
            [0, 8, 1, 1, 8, 7, 7, 7, 7, 7, 8, 1, 1, 8, 0, 0],
            [8, 2, 2, 1, 1, 8, 8, 8, 8, 8, 1, 1, 2, 2, 8, 0], // 2=濃い金/茶の首回り
            [8, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 8, 0],
            [0, 8, 8, 2, 2, 2, 2, 2, 2, 2, 2, 2, 8, 8, 0, 0],
            [0, 0, 0, 8, 8, 8, 8, 8, 8, 8, 8, 8, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv8_glitch': {
        palette: "[null, '#4ade80', '#166534', '#000', '#fff', '#ef4444', '#facc15', '#a855f7', '#0ea5e9']",
        data: `[
            [0, 0, 0, 8, 8, 8, 0, 0, 0, 0, 0, 8, 8, 8, 0, 0], // カエルベースの輪郭
            [0, 0, 8, 1, 4, 1, 8, 0, 0, 0, 8, 1, 4, 1, 8, 0], // 1=緑顔, 4=白
            [0, 0, 8, 1, 3, 3, 8, 8, 8, 8, 8, 3, 3, 1, 8, 0], // 目(3=黒) - ここですでにバグっぽく片方ズレても良いかも
            [0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0],
            [5, 5, 5, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 5, 5], // 5=赤ノイズ
            [5, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 5], 
            [5, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 5],
            [0, 0, 8, 1, 3, 3, 3, 3, 3, 3, 3, 1, 1, 8, 0, 0], // 大きな口
            [0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0],
            [7, 7, 7, 7, 7, 8, 1, 1, 1, 1, 1, 8, 7, 7, 7, 7], // 7=紫ノイズ
            [7, 0, 0, 0, 0, 8, 1, 2, 2, 1, 1, 8, 0, 0, 0, 7], // 2=濃緑
            [7, 0, 0, 0, 0, 8, 1, 2, 2, 1, 1, 8, 0, 0, 0, 7],
            [0, 0, 0, 6, 6, 6, 6, 8, 8, 6, 6, 6, 6, 0, 0, 0], // 6=黄ノイズ
            [0, 0, 0, 8, 8, 8, 8, 0, 0, 8, 8, 8, 8, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv9_emperor': {
        palette: "[null, '#facc15', '#ca8a04', '#000', '#fff', '#ef4444', '#b91c1c', '#fef08a', '#172554']",
        data: `[
            [0, 0, 0, 0, 0, 0, 5, 0, 0, 5, 0, 0, 0, 0, 0, 0], // 5=赤(冠の宝石)
            [0, 0, 0, 0, 0, 8, 1, 8, 8, 1, 8, 0, 0, 0, 0, 0], // 1=黄金(帝王)
            [0, 0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0], // 8=黒の装飾枠
            [0, 0, 0, 8, 1, 7, 7, 5, 5, 7, 7, 1, 8, 0, 0, 0], // 7=白金ハイライト
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0],
            [0, 0, 0, 8, 1, 4, 3, 1, 1, 3, 4, 1, 8, 0, 0, 0], // 鋭く威厳のある目
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0],
            [0, 0, 0, 8, 1, 1, 3, 3, 3, 3, 1, 1, 8, 0, 0, 0], // 威厳ある口文字
            [0, 0, 0, 8, 1, 1, 1, 2, 2, 1, 1, 1, 8, 0, 0, 0], // 2=濃い金
            [0, 0, 8, 8, 8, 1, 2, 5, 5, 2, 1, 8, 8, 8, 0, 0], // 豪華なマント開始
            [0, 8, 2, 2, 2, 8, 6, 6, 6, 6, 8, 2, 2, 2, 8, 0], // 6=濃赤(マント)
            [0, 8, 2, 2, 2, 8, 6, 6, 6, 6, 8, 2, 2, 2, 8, 0],
            [8, 2, 2, 2, 2, 2, 8, 8, 8, 8, 2, 2, 2, 2, 2, 8],
            [8, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 8],
            [0, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv9_origin': {
        palette: "[null, '#38bdf8', '#0ea5e9', '#000', '#fff', '#e0f2fe', '#0284c7', '#1e3a8a', '#fbbf24']",
        data: `[
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 5, 5, 5, 5, 0, 0, 0, 0, 0, 0], // 5=白水色(輝くエネルギー)
            [0, 0, 0, 0, 5, 5, 4, 4, 4, 4, 5, 5, 0, 0, 0, 0], // 4=純白
            [0, 0, 0, 5, 4, 1, 1, 1, 1, 1, 1, 4, 5, 0, 0, 0], // 1=メイン水色
            [0, 0, 5, 4, 1, 1, 4, 4, 4, 4, 1, 1, 4, 5, 0, 0], // 内部光
            [0, 5, 4, 1, 1, 4, 8, 8, 8, 8, 4, 1, 1, 4, 5, 0], // コア(8=超濃青か金)
            [0, 5, 4, 1, 4, 8, 7, 7, 7, 7, 8, 4, 1, 4, 5, 0], // 7=金・光
            [0, 5, 4, 1, 4, 8, 7, 4, 4, 7, 8, 4, 1, 4, 5, 0], // 神秘の瞳
            [0, 5, 4, 1, 4, 8, 7, 7, 7, 7, 8, 4, 1, 4, 5, 0],
            [0, 5, 4, 1, 1, 4, 8, 8, 8, 8, 4, 1, 1, 4, 5, 0],
            [0, 0, 5, 4, 1, 1, 4, 4, 4, 4, 1, 1, 4, 5, 0, 0],
            [0, 0, 0, 5, 4, 1, 1, 1, 1, 1, 1, 4, 5, 0, 0, 0],
            [0, 0, 0, 0, 5, 5, 4, 4, 4, 4, 5, 5, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 5, 5, 5, 5, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv9_seraph': {
        palette: "[null, '#f472b6', '#db2777', '#000', '#fff', '#fef08a', '#eab308', '#fbcfe8', '#fdf2f8']",
        data: `[
            [0, 0, 0, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 0, 0, 0], // 六枚羽の熾天使 (5=金)
            [0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0],
            [0, 4, 4, 0, 0, 0, 5, 5, 5, 5, 0, 0, 0, 4, 4, 0], // 4=純白の羽
            [4, 4, 4, 4, 0, 5, 8, 8, 8, 8, 5, 0, 4, 4, 4, 4],
            [4, 4, 4, 4, 8, 1, 1, 1, 1, 1, 1, 8, 4, 4, 4, 4], // 1=メインピンク
            [0, 4, 4, 8, 1, 3, 3, 1, 1, 3, 3, 1, 8, 4, 4, 0], // 目(穏やかな)
            [4, 4, 4, 8, 1, 4, 3, 1, 1, 3, 4, 1, 8, 4, 4, 4],
            [4, 4, 4, 8, 1, 1, 1, 1, 1, 1, 1, 1, 8, 4, 4, 4], // 中段の羽
            [0, 4, 4, 8, 1, 1, 5, 5, 5, 5, 1, 1, 8, 4, 4, 0],
            [4, 4, 4, 8, 1, 2, 2, 2, 2, 2, 2, 1, 8, 4, 4, 4], // ドレス
            [4, 4, 4, 0, 8, 2, 2, 2, 2, 2, 2, 8, 0, 4, 4, 4], // 下段の羽
            [0, 4, 4, 0, 8, 2, 2, 2, 2, 2, 2, 8, 0, 4, 4, 0],
            [0, 0, 0, 0, 0, 8, 8, 8, 8, 8, 8, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv9_leviathan': {
        palette: "[null, '#6b7280', '#374151', '#000', '#fff', '#fef08a', '#eab308', '#0ea5e9', '#0284c7']",
        data: `[
            [0, 0, 0, 0, 0, 0, 8, 8, 8, 8, 0, 0, 0, 0, 0, 0], // 巨大な海獣/獣
            [0, 0, 0, 0, 0, 8, 7, 7, 7, 7, 8, 0, 0, 0, 0, 0], // 7=鱗(水色)
            [0, 0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0], // 1=メイン青灰
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0],
            [0, 0, 8, 1, 1, 5, 5, 1, 1, 5, 5, 1, 1, 8, 0, 0], // 5=黄・光る目
            [0, 8, 1, 1, 1, 4, 5, 1, 1, 5, 4, 1, 1, 1, 8, 0], // ハイライト(白・獣の狂気)
            [8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8],
            [8, 1, 1, 1, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 1, 8], // 巨大な口
            [8, 1, 1, 8, 4, 2, 4, 2, 4, 2, 4, 2, 8, 1, 1, 8], // 4=牙, 2=口の中(濃灰)
            [8, 1, 1, 8, 4, 2, 4, 2, 4, 2, 4, 2, 8, 1, 1, 8],
            [0, 8, 1, 1, 8, 8, 8, 8, 8, 8, 8, 8, 1, 1, 8, 0],
            [0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0],
            [0, 0, 0, 8, 8, 1, 1, 1, 1, 1, 1, 8, 8, 0, 0, 0],
            [0, 0, 0, 0, 0, 8, 8, 8, 8, 8, 8, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv9_paradox': {
        palette: "[null, '#ef4444', '#b91c1c', '#000', '#fff', '#a855f7', '#7e22ce', '#38bdf8', '#0ea5e9']",
        data: `[
            [0, 0, 0, 5, 5, 5, 0, 0, 0, 0, 7, 7, 7, 0, 0, 0], // 5=紫(左半身), 7=水色(右半身)
            [0, 0, 5, 6, 6, 6, 5, 0, 0, 7, 8, 8, 8, 7, 0, 0], // 6=濃紫(左の模様), 8=濃青(右の模様) - 8は黒だけど...
            [0, 5, 6, 6, 6, 6, 6, 5, 7, 8, 8, 8, 8, 8, 7, 0], // 黒が8だから、色を変えよう。右は1=赤にしようか(パレット1は赤) -> 赤と紫の融合に。
            [0, 5, 5, 5, 5, 5, 5, 3, 3, 1, 1, 1, 1, 1, 1, 0], // 中央は3=黒で分断
            [5, 5, 4, 3, 5, 5, 5, 3, 3, 1, 1, 1, 3, 4, 1, 1], // 左の眼(白に黒目), 右の眼(赤ベースに白黒)
            [5, 5, 3, 3, 5, 5, 5, 3, 3, 1, 1, 1, 3, 3, 1, 1],
            [5, 5, 5, 5, 5, 5, 5, 3, 3, 1, 1, 1, 1, 1, 1, 1],
            [0, 5, 5, 5, 5, 5, 3, 3, 3, 3, 1, 1, 1, 1, 1, 0],
            [0, 0, 5, 5, 5, 3, 3, 0, 0, 3, 3, 1, 1, 1, 0, 0], // バグ空間
            [0, 0, 0, 5, 3, 3, 0, 0, 0, 0, 3, 3, 1, 0, 0, 0],
            [0, 0, 0, 3, 5, 5, 3, 0, 0, 3, 1, 1, 3, 0, 0, 0],
            [0, 0, 3, 5, 5, 5, 5, 3, 3, 1, 1, 1, 1, 3, 0, 0],
            [0, 3, 5, 5, 5, 5, 5, 5, 1, 1, 1, 1, 1, 1, 3, 0],
            [0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    }
};

const FILES = ['./src/pixel-engine.js', './src/pixel-engine-static.js'];

// パレットのインデックス（番号）とパレット配列の関係に少し注意。
// 0=透明、1=メイン... となっているが、paradox のようにパレットをそのまま使っている。

function replaceMonsterData(source) {
    let result = source;
    for (const [id, newData] of Object.entries(NEW_MONSTER_DATA)) {
        const blockRegex = new RegExp(`(id:\\s*'${id}'.*?palette:\\s*\\[)(.*?)(\\],.*?data:\\s*\\[)(.*?)(\\]\\s*\\n*\\s*\\})`, 'gs');

        result = result.replace(blockRegex, (match, p1, p2, p3, p4, p5) => {
            let replacementPalette = newData.palette.trim();
            if (replacementPalette.startsWith('[')) replacementPalette = replacementPalette.substring(1);
            if (replacementPalette.endsWith(']')) replacementPalette = replacementPalette.substring(0, replacementPalette.length - 1);

            let replacementData = newData.data.trim();
            if (replacementData.startsWith('[')) replacementData = replacementData.substring(1);
            if (replacementData.endsWith(']')) replacementData = replacementData.substring(0, replacementData.length - 1);

            return p1 + replacementPalette + p3 + replacementData + p5;
        });
    }
    return result;
}

FILES.forEach(file => {
    if (fs.existsSync(file)) {
        let src = fs.readFileSync(file, 'utf8');
        let updated = replaceMonsterData(src);
        fs.writeFileSync(file, updated, 'utf8');
        console.log(`Updated ${file}`);
    }
});
