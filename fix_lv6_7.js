import fs from 'fs';

const NEW_MONSTER_DATA = {
    'lv6_titan': {
        palette: "[null, '#78350f', '#451a03', '#000', '#fff', '#facc15', '#fefce8', '#b45309', '#92400e']",
        data: `[
            [0, 0, 0, 0, 0, 8, 8, 8, 8, 8, 0, 0, 0, 0, 0, 0], // 8=岩の濃い輪郭/影(#92400e)
            [0, 0, 0, 0, 8, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0, 0], // 1=メイン茶
            [0, 0, 0, 8, 1, 7, 7, 1, 7, 1, 1, 8, 0, 0, 0, 0], // 7=ハイライト茶
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0],
            [0, 0, 0, 8, 1, 5, 5, 5, 5, 5, 1, 8, 0, 0, 0, 0], // 5=黄(光る目)
            [0, 0, 0, 8, 1, 5, 6, 5, 6, 5, 1, 8, 0, 0, 0, 0], // 6=白より黄(中心光)
            [0, 0, 0, 8, 1, 5, 5, 5, 5, 5, 1, 8, 0, 0, 0, 0],
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0],
            [0, 8, 8, 8, 1, 1, 2, 2, 2, 1, 1, 8, 8, 8, 0, 0], // 2=濃茶
            [8, 1, 1, 8, 1, 2, 2, 2, 2, 2, 1, 8, 1, 1, 8, 0],
            [8, 1, 7, 8, 2, 2, 2, 2, 2, 2, 2, 8, 1, 7, 8, 0],
            [0, 8, 8, 8, 2, 2, 2, 4, 2, 2, 2, 8, 8, 8, 0, 0], // 腕・肩
            [0, 0, 0, 8, 1, 1, 8, 8, 8, 1, 1, 8, 0, 0, 0, 0], // 足
            [0, 0, 0, 8, 2, 2, 8, 0, 8, 2, 2, 8, 0, 0, 0, 0],
            [0, 0, 0, 8, 2, 2, 8, 0, 8, 2, 2, 8, 0, 0, 0, 0],
            [0, 0, 0, 8, 8, 8, 8, 0, 8, 8, 8, 8, 0, 0, 0, 0]
        ]`
    },
    'lv6_oracle': {
        palette: "[null, '#38bdf8', '#0284c7', '#000', '#fff', '#c084fc', '#fef08a', '#1e3a8a', '#0c4a6e']",
        data: `[
            [0, 0, 0, 0, 6, 6, 6, 0, 6, 6, 6, 0, 0, 0, 0, 0], // 6=黄の光
            [0, 0, 0, 0, 0, 8, 8, 8, 8, 8, 0, 0, 0, 0, 0, 0], // フード
            [0, 0, 0, 0, 8, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0, 0], // 1=青
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0],
            [0, 0, 0, 8, 1, 3, 3, 1, 3, 3, 1, 8, 0, 0, 0, 0], // 3=瞳(黒)
            [0, 0, 0, 8, 1, 3, 4, 1, 3, 4, 1, 8, 0, 0, 0, 0], // 4=白
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0],
            [0, 0, 0, 8, 1, 1, 5, 5, 5, 1, 1, 8, 0, 0, 0, 0], // 5=紫オーブ
            [0, 0, 8, 1, 1, 2, 2, 2, 2, 2, 1, 1, 8, 0, 0, 0], // 2=濃青ローブ
            [0, 8, 1, 1, 2, 2, 2, 2, 2, 2, 2, 1, 1, 8, 0, 0],
            [0, 8, 1, 2, 2, 2, 6, 6, 6, 2, 2, 2, 1, 8, 0, 0], // 6=ローブの金線
            [8, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 8, 0],
            [8, 2, 2, 2, 2, 8, 8, 8, 8, 8, 2, 2, 2, 2, 8, 0], // 浮遊感
            [0, 8, 8, 8, 8, 0, 0, 0, 0, 0, 8, 8, 8, 8, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv6_fairy': {
        palette: "[null, '#86efac', '#16a34a', '#000', '#fff', '#fbcfe8', '#f472b6', '#bef264', '#14532d']",
        data: `[
            [0, 0, 0, 0, 0, 5, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0], // 5=ピンク触角
            [0, 0, 0, 0, 0, 6, 5, 0, 5, 6, 0, 0, 0, 0, 0, 0], // 6=濃ピンク
            [0, 0, 0, 4, 8, 7, 7, 7, 7, 7, 8, 4, 0, 0, 0, 0], // 4=白羽, 7=黄緑
            [0, 0, 4, 4, 8, 1, 1, 1, 1, 1, 8, 4, 4, 0, 0, 0], // 1=緑顔
            [0, 4, 4, 0, 8, 3, 3, 1, 3, 3, 8, 0, 4, 4, 0, 0], // 3=笑顔の目(黒)
            [0, 4, 0, 0, 8, 1, 1, 1, 1, 1, 8, 0, 0, 4, 0, 0],
            [4, 0, 0, 0, 8, 5, 1, 3, 1, 5, 8, 0, 0, 0, 4, 0], // 5=ほっぺ
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0],
            [0, 0, 8, 1, 1, 2, 2, 2, 2, 2, 1, 1, 8, 0, 0, 0], // 2=濃緑ドレス
            [0, 0, 8, 1, 5, 2, 2, 2, 2, 2, 5, 1, 8, 0, 0, 0], // 花飾り
            [0, 0, 8, 2, 2, 2, 5, 5, 5, 2, 2, 2, 8, 0, 0, 0],
            [0, 0, 8, 2, 2, 2, 2, 2, 2, 2, 2, 2, 8, 0, 0, 0],
            [0, 0, 0, 8, 8, 8, 8, 8, 8, 8, 8, 8, 0, 0, 0, 0],
            [0, 0, 0, 0, 8, 1, 8, 0, 8, 1, 8, 0, 0, 0, 0, 0], // 脚
            [0, 0, 0, 0, 8, 8, 0, 0, 0, 8, 8, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv6_phantom': {
        palette: "[null, '#db2777', '#9d174d', '#000', '#fff', '#e879f9', '#fbcfe8', '#831843', '#4c0519']",
        data: `[
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 8, 8, 8, 8, 8, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 8, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0, 0], // 1=メイン(赤紫)
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0],
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0],
            [0, 0, 8, 1, 1, 5, 5, 1, 5, 5, 1, 1, 8, 0, 0, 0], // 5=光る目(ピンク)
            [0, 0, 8, 1, 1, 5, 6, 1, 5, 6, 1, 1, 8, 0, 0, 0], // 6=白ピンク
            [0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0],
            [0, 0, 0, 8, 1, 1, 3, 3, 3, 1, 1, 8, 0, 0, 0, 0], // 3=不敵な口
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0],
            [0, 0, 0, 0, 8, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 8, 1, 1, 1, 8, 0, 0, 0, 0, 0, 0], // 尻尾っぽく
            [0, 0, 0, 0, 0, 0, 8, 1, 1, 8, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 8, 1, 1, 8, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 8, 8, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv7_dragon': {
        palette: "[null, '#dc2626', '#991b1b', '#000', '#fcd34d', '#fbbf24', '#f59e0b', '#7f1d1d', '#450a0a']",
        data: `[
            [0, 0, 0, 0, 0, 0, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0], // 5=金(剣の先)
            [0, 0, 0, 0, 0, 0, 1, 4, 1, 0, 0, 0, 0, 0, 0, 0], // 1=赤の刀身, 4=金ハイライト
            [0, 0, 0, 0, 0, 1, 1, 4, 1, 1, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 1, 1, 3, 4, 3, 1, 1, 0, 0, 0, 0, 0], // 3=目のような模様
            [0, 0, 0, 0, 1, 1, 3, 4, 3, 1, 1, 0, 0, 0, 0, 0],
            [0, 0, 0, 1, 1, 1, 8, 8, 8, 1, 1, 1, 0, 0, 0, 0], // 8=黒の溝
            [0, 0, 0, 1, 1, 1, 8, 8, 8, 1, 1, 1, 0, 0, 0, 0],
            [0, 0, 1, 1, 1, 1, 8, 8, 8, 1, 1, 1, 1, 0, 0, 0],
            [0, 0, 1, 1, 1, 1, 8, 8, 8, 1, 1, 1, 1, 0, 0, 0],
            [0, 0, 1, 1, 1, 1, 8, 8, 8, 1, 1, 1, 1, 0, 0, 0],
            [0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0], // 2=濃赤の鍔
            [0, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 0], // 6=金の鍔飾り
            [0, 0, 0, 0, 0, 3, 1, 1, 1, 3, 0, 0, 0, 0, 0, 0], // 3=黒の柄
            [0, 0, 0, 0, 0, 3, 1, 1, 1, 3, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 5, 5, 5, 0, 0, 0, 0, 0, 0, 0], // 柄頭
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv7_cosmos': {
        palette: "[null, '#1e1b4b', '#312e81', '#818cf8', '#e0e7ff', '#c7d2fe', '#4f46e5', '#0f172a', '#020617']",
        data: `[
            [0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], // 1=メイン(濃紺本)
            [0, 1, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 1, 0], // 7=青紫の表紙装飾
            [1, 7, 1, 1, 1, 1, 5, 5, 1, 1, 1, 1, 1, 7, 1, 0], // 5=白金の星模様
            [1, 7, 1, 1, 1, 5, 5, 5, 5, 1, 1, 1, 1, 7, 1, 0],
            [1, 7, 1, 1, 1, 5, 3, 3, 5, 1, 1, 1, 1, 7, 1, 0], // 3=目(黒)
            [1, 7, 1, 1, 1, 5, 3, 4, 5, 1, 1, 1, 1, 7, 1, 0], // 4=白
            [1, 7, 1, 1, 1, 5, 5, 5, 5, 1, 1, 1, 1, 7, 1, 0],
            [1, 7, 1, 1, 1, 1, 5, 5, 1, 1, 1, 1, 1, 7, 1, 0],
            [1, 7, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 7, 1, 0],
            [1, 7, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 7, 1, 0], // 6=明るい紫インク
            [1, 7, 1, 1, 6, 6, 6, 6, 6, 6, 1, 1, 1, 7, 1, 0],
            [1, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
            [0, 0, 0, 8, 8, 0, 0, 0, 0, 8, 8, 0, 0, 0, 0, 0], // 8=浮遊エフェクト黒
            [0, 0, 8, 8, 8, 8, 0, 0, 8, 8, 8, 8, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv7_goddess': {
        palette: "[null, '#fb7185', '#e11d48', '#000', '#fff', '#fbbf24', '#f59e0b', '#881337', '#4c0519']",
        data: `[
            [0, 0, 0, 0, 0, 0, 0, 0, 5, 5, 5, 5, 5, 0, 0, 0], // 5=金(音符の旗)
            [0, 0, 0, 0, 0, 0, 0, 0, 5, 5, 5, 5, 5, 5, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 8, 8, 0, 0, 0, 0, 0, 0], // 8=くろ(棒)
            [0, 0, 0, 0, 0, 0, 0, 0, 8, 8, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 8, 8, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 8, 8, 8, 8, 8, 8, 8, 8, 0, 0, 0, 0, 0], // 頭装飾
            [0, 0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0], // 1=メインピンク丸
            [0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0],
            [0, 8, 1, 1, 3, 3, 1, 1, 3, 3, 1, 1, 8, 0, 0, 0], // 3=笑顔の目
            [0, 8, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0],
            [0, 0, 8, 1, 1, 1, 2, 2, 1, 1, 1, 8, 0, 0, 0, 0], // 2=濃ピンク口
            [0, 0, 0, 8, 1, 1, 1, 1, 1, 1, 8, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 8, 8, 8, 8, 8, 8, 0, 0, 0, 0, 0, 0],
            [0, 0, 8, 8, 0, 0, 0, 0, 0, 0, 8, 8, 0, 0, 0, 0], // 音を奏でる足
            [0, 8, 8, 0, 0, 0, 0, 0, 0, 0, 0, 8, 8, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv7_chimera': {
        palette: "[null, '#f472b6', '#a855f7', '#000', '#fff', '#38bdf8', '#22c55e', '#fbbf24', '#ef4444']",
        data: `[
            [0, 0, 0, 8, 0, 0, 0, 7, 0, 0, 0, 6, 0, 0, 0, 0], // 8=赤, 7=黄, 6=緑のペンキ飛沫
            [0, 0, 8, 8, 8, 0, 7, 7, 7, 0, 6, 6, 6, 0, 0, 0],
            [0, 0, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0], // 3=黒のアウトライン
            [0, 0, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 0, 0, 0], // 1=メインピンク
            [0, 5, 5, 5, 1, 1, 1, 1, 1, 1, 1, 5, 5, 5, 0, 0], // 5=水色の飾り
            [5, 4, 3, 1, 3, 1, 1, 3, 1, 1, 1, 3, 4, 5, 0, 0], // 4=白目, 3=黒目
            [5, 1, 1, 1, 3, 1, 1, 3, 1, 1, 1, 1, 1, 5, 0, 0],
            [3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 0, 0],
            [3, 1, 1, 3, 3, 3, 3, 3, 3, 3, 1, 1, 1, 3, 0, 0], // にっこり大きな口
            [0, 3, 1, 1, 8, 8, 8, 8, 8, 1, 1, 1, 3, 0, 0, 0], // 8=赤の舌
            [0, 0, 3, 1, 1, 1, 1, 1, 1, 1, 1, 3, 0, 0, 0, 0],
            [0, 0, 0, 6, 6, 6, 6, 6, 6, 6, 3, 0, 0, 0, 0, 0], // 尻尾(虹色グラデ)
            [0, 0, 6, 6, 6, 5, 5, 5, 7, 7, 7, 0, 0, 0, 0, 0],
            [0, 6, 6, 5, 5, 5, 7, 7, 7, 8, 8, 8, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    },
    'lv7_void': {
        palette: "[null, '#1e293b', '#0f172a', '#000', '#fff', '#a855f7', '#7c3aed', '#6366f1', '#4f46e5']",
        data: `[
            [0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0], // 3=真っ黒のアウトライン
            [0, 0, 0, 0, 3, 5, 5, 5, 5, 5, 3, 0, 0, 0, 0, 0], // 5=紫
            [0, 0, 0, 3, 5, 6, 6, 6, 6, 6, 5, 3, 0, 0, 0, 0], // 6=濃い紫
            [0, 0, 3, 5, 6, 4, 4, 4, 4, 6, 5, 3, 0, 0, 0, 0], // 4=白(光る眼)
            [0, 3, 5, 6, 4, 3, 3, 3, 3, 4, 6, 5, 3, 0, 0, 0], // 裂け目の中の闇(3)
            [0, 3, 5, 6, 4, 3, 3, 3, 3, 4, 6, 5, 3, 0, 0, 0],
            [0, 3, 5, 6, 4, 3, 3, 3, 3, 4, 6, 5, 3, 0, 0, 0],
            [0, 0, 3, 5, 6, 4, 4, 4, 4, 6, 5, 3, 0, 0, 0, 0],
            [0, 0, 0, 3, 5, 6, 6, 6, 6, 6, 5, 3, 0, 0, 0, 0],
            [0, 0, 0, 0, 3, 5, 5, 5, 5, 5, 3, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0],
            [0, 7, 7, 0, 0, 0, 0, 0, 0, 0, 0, 7, 7, 0, 0, 0], // 7=青(空間のゆがみ)
            [7, 7, 7, 7, 0, 0, 0, 0, 0, 0, 7, 7, 7, 7, 0, 0],
            [0, 7, 7, 0, 0, 0, 0, 0, 0, 0, 0, 7, 7, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ]`
    }
};

const FILES = ['./src/pixel-engine.js', './src/pixel-engine-static.js'];

// IDが一意でない場合（lv7_chimera等）も全て置換するため g フラグを追加
function replaceMonsterData(source) {
    let result = source;
    for (const [id, newData] of Object.entries(NEW_MONSTER_DATA)) {
        const blockRegex = new RegExp(`(id:\\s*'${id}'.*?palette:\\s*\\[)(.*?)(\\],.*?data:\\s*\\[)(.*?)(\\]\\s*\\n*\\s*\\})`, 'gs');

        result = result.replace(blockRegex, (match, p1, p2, p3, p4, p5) => {
            let replacementPalette = newData.palette.trim();
            if (replacementPalette.startsWith('[')) replacementPalette = replacementPalette.substring(1);
            if (replacementPalette.endsWith(']')) replacementPalette = replacementPalette.substring(0, replacementPalette.length - 1);

            let replacementData = newData.data.trim();
            if (replacementData.startsWith('[')) replacementData = replacementData.substring(1);
            if (replacementData.endsWith(']')) replacementData = replacementData.substring(0, replacementData.length - 1);

            return p1 + replacementPalette + p3 + replacementData + p5;
        });
    }
    return result;
}

FILES.forEach(file => {
    if (fs.existsSync(file)) {
        let src = fs.readFileSync(file, 'utf8');
        let updated = replaceMonsterData(src);
        fs.writeFileSync(file, updated, 'utf8');
        console.log(`Updated ${file}`);
    }
});
